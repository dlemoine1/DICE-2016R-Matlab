% Initial guesses and bounds for DICE-2016R

% Last edited: July 24, 2021 by Derek Lemoine

% guess columns need to be ordered abatement rate, savings rate (if endogenous),
% and final column alpha (if using FAIR)
guessed_timestep = 5; % timestep used for guess
guessed_horizon = 500;
switch Params.carbonmodel
    case 'dice' % from dice climate module
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
    case 'joos' % from updated climate module
        guess = [0.138766025229609,0.261355650778958,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000;0.158232121541979,0.257774927155944,268.828540714191,1.25405498137236,0.0354688000000000,737.270309563312,99.5620136317820,38.6823878903873,14.2462912181536;0.178861598852014,0.254902080853013,319.767594268416,1.46041047635746,0.0769007301666603,748.109972844115,109.497577625119,47.8218212693349,18.2418726789481;0.200964816637435,0.252529028729608,376.314258426531,1.60934494478798,0.123940061537148,759.546932641082,119.925279420483,56.5685209373469,20.2519604459386;0.224669301034988,0.250538405760977,438.804819499663,1.74086001542456,0.174443827567676,771.496536625502,130.751735567444,64.8627062139489,21.5329521292936;0.250047735640455,0.248866040449451,507.482281894394,1.86604847162159,0.227701977954810,783.863053580480,141.873303603822,72.6378446519579,22.4640131769912;0.277159596003813,0.247468359224984,582.554140360052,1.98766250088227,0.283405758739481,796.541415941623,153.178005922107,79.8237801978931,23.1519510646340;0.306063215083351,0.246311761156828,664.217016651131,2.10606428343167,0.341350487972335,809.419183448169,164.547657635402,86.3497485995627,23.6208220415808;0.336819702492889,0.245367705910178,752.667333695670,2.22095458204246,0.401350757017952,822.378434279465,175.859893227239,92.1469128913929,23.8711858327349;0.369492561806846,0.244611604263574,848.104640410563,2.33187556369268,0.463217287068786,835.297463582024,186.989969446461,97.1503242680907,23.8984074526293;0.404147530090185,0.244021789324438,950.733081643521,2.43835526483681,0.526751668473998,848.052285517604,197.812343241315,101.300376813045,23.6981358468297;0.440850987635811,0.243579163121350,1060.76131386003,2.53994604599294,0.591746190750334,860.517936531254,208.202025158752,104.543817829189,23.2677659549315;0.479666779476185,0.243266547303468,1178.40213927376,2.63623130848755,0.657984985828583,872.569623776209,218.035756293171,106.834427712320,22.6066994509670;0.520655917790238,0.243068130516818,1303.87119983451,2.72682282988436,0.725245360798987,884.083781541215,227.193075762564,108.133493307062,21.7163093789564;0.563873327464842,0.242968645352291,1437.38468548856,2.81135501626079,0.793298994747890,894.939000263111,235.557243564439,108.410055132205,20.5997670741925;0.609362949091072,0.242952144896615,1579.15500368478,2.88947863034458,0.861912899479328,905.016912434589,243.016107519714,107.641066966493,19.2619331812355;0.657155326911083,0.243000223532880,1729.38256591527,2.96085500816073,0.930850134328747,914.203095123787,249.462976557877,105.811556611201,17.7093446647114;0.707289730067529,0.243088350537410,1888.24069906153,3.02515059672562,0.999870300039034,922.387950500801,254.797460469339,102.914737508625,15.9501827791924;0.760040062044353,0.243260018167180,2055.84433359731,3.07067483993115,1.06872983012638,929.466989666827,258.925684117929,98.9513306246545,13.9935043346887;0.815541400018391,0.243445348180264,2232.69316212182,3.10518985309622,1.13679596045974,935.335579939161,261.754791736946,93.9217778511016,11.8419612891817;0.873901372147837,0.243583665539123,2418.86412092860,3.13045924395660,1.20372135280938,939.892790550802,263.196898524466,87.8312755171460,9.50109074320877;0.935255145518280,0.243582445853032,2614.14052418563,3.14660498040351,1.26923044110839,943.041913043650,263.169565254639,80.6898425725041,6.97799453407991;0.999773192358015,0.243277968712922,2817.85518283352,3.15326255756613,1.33306117544442,944.690130357653,261.595389433683,72.5112737070209,4.27984350387357;0.999999918661969,0.243540092778766,3028.47238448467,3.14987706895579,1.39494802243656,944.748193785279,258.401609648767,63.3122365923094,1.41341933623568;0.999999952716746,0.243767709826696,3251.97143822708,3.14770231029619,1.45461561001821,944.794645527795,255.235583290716,55.2747044608768,0.501464247394265;0.999999963175748,0.243987339273607,3487.36200130518,3.14768003101845,1.51218055782766,944.835754711029,252.103427593422,48.2582632290396,0.209229196086027;0.999999967356903,0.244233630928788,3734.00648848403,3.14929735247069,1.56778753991615,944.872136212547,249.005355121312,42.1331101814551,0.111748321177564;0.999999967946070,0.244550306671658,3991.66677611387,3.15209769975791,1.62155887354300,944.904333839589,245.941502533375,36.7859525515880,0.0759169554839950;0.999999962244638,0.245005533179357,4260.52979887998,3.15578976998012,1.67359719363431,944.932828812679,242.911940272434,32.1179068553036,0.0599937627538522;1.13943690167674,0.244236030186500,4541.37645181468,3.16018203777023,1.72399174123007,944.958047085850,239.916680934648,28.0426653965834,0.0508434340266005;1.09656007399470,0.244701413044485,4818.96160871025,3.14013727561604,1.77282221131243,941.642383911357,233.514784924542,20.1469022081675,-4.19999827152522;1.09748281783550,0.244872672353350,5113.42972868793,3.12677096061854,1.81931092349876,939.373121328224,228.271177703414,14.6209275691465,-4.19999854357684;1.09853101849317,0.245025907222613,5418.57826945692,3.11568164355146,1.86376456476083,937.103858801837,223.092788723884,9.80174829825269,-4.19999855657656;1.09970664914551,0.245171641606228,5733.70306731418,3.10559606388611,1.90632974543971,934.834596288220,217.978806778562,5.59896225129925,-4.19999854440803;1.10101027439183,0.245314102257195,6058.36379357732,3.09609093781299,1.94710480026689,932.565333796511,212.928430804331,1.93373016589270,-4.19999851274273;1.10244213281793,0.245454895837588,6392.23345831685,3.08698069457214,1.98617032894346,930.296071334611,207.940869700143,-1.26270335019739,-4.19999846492951;1.10400256319914,0.245594582545488,6735.03464845746,3.07815225628161,2.02359788137483,928.026808909783,203.015342203735,-4.05029958747454,-4.19999840282674;1.10569217440058,0.245733217114559,7086.51098346851,3.06951982520644,2.05945273012166,925.757546528931,198.151076769548,-6.48135053678619,-4.19999832747193;1.10751191771178,0.245870942010196,7446.41208956283,3.06101193544460,2.09379501135454,923.488284198821,193.347311448098,-8.60145982457611,-4.19999823936571;1.10946309478152,0.246007690258190,7814.48996455611,3.05256722774168,2.12668038677361,921.219021926272,188.603293766819,-10.4503981824505,-4.19999813859976;1.11154737363638,0.246142845676091,8190.49260813516,3.04413263012950,2.15816053936652,918.949759718285,183.918280612330,-12.0628494986787,-4.19999802496934;1.11376681657492,0.246276982149269,8574.15380896029,3.03566224710017,2.18828359045246,916.680497582147,179.291538114134,-13.4690614466210,-4.19999789804536;1.11612379228586,0.246409577370294,8965.21169982773,3.02711649872822,2.21709446477848,914.411235525519,174.722341529745,-14.6954128950796,-4.19999775721998;1.11862104754423,0.246540041420038,9363.38866827337,3.01846138295653,2.24463521393278,912.141973556520,170.209975131251,-15.7649087444884,-4.19999760171964;1.12126169657773,0.246669124422714,9768.39101277417,3.00966782298996,2.27094530367958,909.872711683814,165.753732093277,-16.6976114714841,-4.19999743061053;1.12404912095477,0.246796050584402,10179.9338553706,3.00071108544007,2.29606186933614,907.603449916677,161.352914382329,-17.5110174771408,-4.19999724282116;1.12698707968792,0.246920336984652,10597.7108601092,2.99157026125347,2.32001994268367,905.334188265105,157.006832647558,-18.2203852986391,-4.19999703710022;1.13007967372850,0.247044117114011,11021.4022540218,2.98222780329492,2.34285265351504,903.064926739907,152.714806112861,-18.8390218413090,-4.19999681202355;1.13333115655149,0.247164384692924,11450.7283927581,2.97266911513963,2.36459140860756,900.795665352637,148.476162470161,-19.3785320006016,-4.19999656619690;1.13674633242191,0.247283214248495,11885.3374800434,2.96288218604801,2.38526605062965,898.526404115839,144.290237774339,-19.8490363559632,-4.19999629792635;1.14033013576442,0.247399909981283,12324.9251295232,2.95285726745359,2.40490499923387,896.257143043259,140.156376339437,-20.2593610207882,-4.19999600515112;1.14408787682163,0.247514248309594,12769.1655259635,2.94258658665339,2.42353537635334,893.987882149749,136.073930635831,-20.6172032101772,-4.19999568582295;1.14802519348156,0.247627434519570,13217.7259775895,2.93206409375604,2.44118311750355,891.718621451515,132.042261189045,-20.9292756314297,-4.19999533757802;1.15214793827063,0.247738260343918,13670.3020796143,2.92128523828088,2.45787307069613,889.449360965978,128.060736479421,-21.2014324068934,-4.19999495812963;1.15646239578374,0.247849412591016,14126.5548317604,2.91024677215194,2.47362908439401,887.180100712314,124.128732843730,-21.4387788898767,-4.19999454453239;1.16097493949982,0.247960919289046,14586.2152004505,2.89894657611690,2.48847408577778,884.910840710062,120.245634376032,-21.6457674371499,-4.19999409540148;1.16569230518853,0.248073655728726,15049.0045921151,2.88738350700396,2.50243015044931,882.641580982959,116.410832835133,-21.8262809249577,-4.19999360496912;1.17062150920454,0.248191334117535,15514.6610972086,2.87555726333421,2.51551856457217,880.372321555749,112.623727545978,-21.9837055921017,-4.19999307014504;1.17576960051984,0.248321727448283,15983.0165606104,2.86346826725493,2.52775988033008,878.103062454840,108.883725306214,-22.1209945611028,-4.19999248784959;1.18114333145186,0.248473546443176,16454.0978843056,2.85111756089318,2.53917396548552,875.833803710841,105.190240295867,-22.2407232322841,-4.19999185177429;1.18674916014836,0.248666127598083,16928.1252854271,2.83850671536845,2.54978004772938,873.564545355265,101.542693982122,-22.3451376003119,-4.19999115879823;1.19259227319154,0.248930377296159,17405.8034131861,2.82563775107282,2.55959675442911,871.295287423333,97.9405150315778,-22.4361963829077,-4.19999040322604;1.19867583870003,0.249324142319582,17888.6015228618,2.81251306781159,2.56864214831500,869.026029953376,94.3831392200866,-22.5156077655583,-4.19998957932531;1.19999937713554,0.249349110953974,18379.4825355285,2.79913535901482,2.57693375957788,866.756770431773,90.8700067104917,-22.5848647661515,-4.19999193014158;1.19999930099904,0.249390306634634,18864.8339522763,2.78604458709285,2.58448861395874,864.542848820953,87.4576134765373,-22.5733471418819,-4.12962973566813;1.19999921479204,0.249439708466813,19346.4843742901,2.77341687226427,2.59134151704530,862.398136727114,84.1590058664964,-22.4733589626870,-4.01960549890178;1.19999911721745,0.249493690430518,19825.4210334000,2.76122338395031,2.59753207912274,860.321251224441,80.9713430884178,-22.2980132137680,-3.89892545381338;1.19999900656730,0.249549968955257,20302.1827387386,2.74942193123438,2.60309758348688,858.310727216988,77.8917349794658,-22.0588524617492,-3.77677303113560;1.19999888109768,0.249606751342147,20777.0240950669,2.73798085221273,2.60807261131030,856.365047334706,74.9172734377853,-21.7660108653408,-3.65608911163912;1.19999873867054,0.249663082411493,21250.0063640282,2.72687665433702,2.61248949150098,854.482661760585,72.0450530840982,-21.4283685495270,-3.53783544766875;1.19999857672283,0.249719441450964,21721.0781303122,2.71609052699803,2.61637865503740,852.662002218343,69.2721856468084,-21.0536938235338,-3.42233653890066;1.19999839242456,0.249774546628596,22190.1595732185,2.70560641513736,2.61976885868407,850.901491649442,66.5958097246071,-20.6487728106078,-3.30970512048676;1.19999818249982,0.249828374697401,22657.0866481096,2.69541009893643,2.62268733560348,849.199550464865,64.0130968968126,-20.2195269489898,-3.19997969606245;1.19999794267449,0.249880821449989,23121.6822262201,2.68548876231595,2.62515990955680,847.554603245141,61.5212582197709,-19.7711148814936,-3.09316701562921;1.19999766730432,0.249932313345300,23583.7588904768,2.67583074493069,2.62721109055061,845.965082965731,59.1175480915231,-19.3080245289823,-2.98925851766286;1.19999735175292,0.249979047358349,24043.1454451943,2.66642537675359,2.62886415879953,844.429434674026,56.7992675031050,-18.8341540999415,-2.88823617277977;1.19999698907131,0.250026299391333,24499.5117696520,2.65726284729593,2.63014124020997,842.946118220288,54.5637662741857,-18.3528839680663,-2.79007551572405;1.19999657248486,0.250071073813360,24952.7856455184,2.64833412993825,2.63106337485089,841.513613816901,52.4084481764137,-17.8671356807750,-2.69474299814530;1.19999609212377,0.250112891317637,25402.7452337140,2.63963084511773,2.63165058052386,840.130419591135,50.3307677396840,-17.3794338254110,-2.60220534038682;1.19999553597985,0.250148500207339,25849.1640760821,2.63114520732725,2.63192190952005,838.795056474391,48.3282346608246,-16.8919504480975,-2.51242313014170;1.19999489102716,0.250174658995687,26291.6913073582,2.62286996096777,2.63189550164550,837.506069973214,46.3984149430676,-16.4065478436539,-2.42535278371749;1.19999413797556,0.250190681965171,26729.8805080965,2.61479833881353,2.63158863326246,836.262033379076,44.5389335044756,-15.9248140026992,-2.34094533049753;1.19999325642446,0.250185631615323,27163.3265226029,2.60692402063598,2.63101776325119,835.061549957007,42.7474757012962,-15.4480948519909,-2.25914733087935;1.19999222930264,0.250139574163255,27591.1814221525,2.59924107555539,2.63019857600228,833.903252875975,41.0217865044826,-14.9775253058864,-2.17990403499425;1.19999101643104,0.250029656040529,28011.8309555699,2.59174397220024,2.62914602098708,832.785811028033,39.3596757568004,-14.5140486932257,-2.10315288372707;1.19998953325942,0.249816380894287,28422.9220843931,2.58442762668297,2.62787435132833,831.707937277048,37.7590258690277,-14.0584305419997,-2.02881838530342;1.19998776293853,0.249407272627455,28820.7143745593,2.57728743100281,2.62639716269039,830.668394351248,36.2177969916181,-13.6112736629435,-1.95681350756257;1.19998562687133,0.248673692919031,29197.7896228764,2.57031932841925,2.62472743181301,829.666005199094,34.7340367229732,-13.1730255034136,-1.88703443856878;1.19998303741582,0.247357705678103,29542.0812035350,2.56352011118909,2.62287755629762,828.699683742716,33.3059107234469,-12.7439580522886,-1.81933301089615;1.19997977627248,0.245033629274380,29831.4289889777,2.55688774374477,2.62085940316393,827.768466635835,31.9317339840513,-12.3241490096888,-1.75350679319915;1.19997557650639,0.258278145695364,30027.4121344311,2.55042211379630,2.61868436674368,826.871586301071,30.6100442583874,-11.9134117190838,-1.68924350157650;1.19997031518853,0.258278145695364,30949.4242759583,2.54412618025107,2.61636345014347,826.008579507094,29.3397112169134,-11.5111878742785,-1.62605841089978;1.19996326227523,0.258278145695364,31723.1375553876,2.53793042398059,2.61390738296713,825.172215002155,28.1126418902841,-11.1257862021853,-1.57240543517855;1.19995339721622,0.258278145695364,32387.7456304703,2.53184313909497,2.61132416636158,824.362992220589,26.9288130126628,-10.7544060186954,-1.52110097335215;1.19993900621875,0.258278145695364,32971.9651598968,2.52587653067617,2.60862181143452,823.580934512486,25.7877108442600,-10.3952235712596,-1.47050190632799;1.19991622735907,0.258278145695364,33496.6967012205,2.52003746474706,2.60580847188874,822.825756899555,24.6885101999487,-10.0470490721116,-1.42048598175117;1.19987627399287,0.258278145695364,33977.0832969545,2.51432874672666,2.60289225764592,822.096983999889,23.6301998836510,-9.70909235816172,-1.37125703550773;1.19978607012923,0.258278145695364,34424.0620879150,2.50875102745655,2.59988109827466,821.394040062866,22.6116778128192,-9.38079476924714,-1.32300648845307;1.19944986447605,0.258278145695364,34845.5152228470,2.50330473395784,2.59678267586685,820.716377438047,21.6318845788244,-9.06163258157869,-1.27575852553043;0.00155866578003304,0.258278145695364,35247.1146861352,2.49799628657043,2.59360442584194,820.064026926239,20.6903702361999,-8.75039731079572,-1.22878520775116];
    case 'fair' % from updated climate module
        guess = [0.265994115188086,0.258829225527144,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000,0.380703525630311;0.303059332698639,0.255568487543982,267.239845535193,1.38916026009311,0.0354688000000000,735.881832752083,131.756994930032,68.2995836169873,17.6297923262479,0.424228409196743;0.341376298553768,0.252932040996776,316.640663464476,1.72921925502859,0.0814943096431658,744.959038130675,173.963128535901,99.8567070041823,20.8511777419956,0.448641883444889;0.382099838661488,0.250812462037538,371.531824867971,1.99212217280897,0.137516957786270,754.226465083949,216.203797669228,125.473018378397,22.6109050927425,0.466161493190880;0.425884007666931,0.249128163603368,432.196719028598,2.21609460385423,0.200573535097042,763.554596493748,257.822811832687,146.041137889668,23.6989792889196,0.482577244174465;0.473213432670770,0.247830343944104,498.879646268263,2.41414995855787,0.269101251434787,772.794552378239,298.129236976047,162.217133742634,24.3389303199266,0.499813745299783;0.524550089310512,0.246882961814658,571.822398803028,2.59106311688665,0.342032907476971,781.780741175728,336.382178503275,174.398983281779,24.5561700875639,0.518652472587882;0.580367609589556,0.246250023082909,651.281176359738,2.74846952491545,0.418499934596901,790.332210209285,371.785801098935,182.747870677737,24.3025087711446,0.539574520207450;0.641142626692275,0.245883645522066,737.525293291307,2.88649781120185,0.497718900667731,798.253558254614,403.488430790466,187.227164350126,23.4966274003344,0.563018088531540;0.707329960601428,0.245706490789725,830.813651043217,3.00432502678976,0.578937383625891,805.335922975984,430.583871316983,187.637648375860,22.0347005144720,0.589459379195826;0.779301464081611,0.245582919021481,931.332307475536,3.10034984050486,0.661400563493463,811.358395461416,452.114908094870,183.643326508986,19.7910002426607,0.619435895804841;0.857284471855074,0.245268619315871,1039.05964636938,3.17220264721228,0.744324838911850,816.090762953831,467.082847957817,174.792520516242,16.6169844801666,0.653538708404887;0.941038332368631,0.244331523789447,1153.49113566286,3.21665196876377,0.826872684394065,819.297959784614,474.464647108210,160.537539869106,12.3406821378543,0.692374377907059;0.999999814029908,0.243297897723050,1273.12503234380,3.22953062902735,0.908125180062635,820.752379473574,473.269012829747,140.291748911928,6.78653243929598,0.736432081975224;0.999999952901035,0.243468281072220,1398.99602258426,3.21960052894332,0.987052965327435,820.909981556808,465.982657114690,117.411269559400,1.90538684605066,0.780447787997512;0.999999969352266,0.243527573537170,1537.07794693251,3.21433405171659,1.06295958249038,821.049456818235,459.174280861263,99.3396924254092,0.891312884784726,0.814867507886109;0.999999975278792,0.243521011757427,1686.26909296669,3.21534271436015,1.13610631444407,821.172892187707,452.704639362409,84.7049268811329,0.632379828430686,0.845838644049217;0.999999977987552,0.243476755466325,1845.79828222748,3.22131777174707,1.20680035204121,821.282132443418,446.517033228361,72.6940940565333,0.537754163905081,0.874751219082253;0.999999979269184,0.243485959671522,2015.15052988343,3.21971992106861,1.27529394431121,821.378810079794,440.575839437008,62.7372847956632,0.482670795754384,0.898312009600543;0.999999979761277,0.243518548056375,2194.47178366552,3.21775421242234,1.34140442752096,821.464369823066,434.828851731709,54.3788512742017,0.437646092194840,0.919441371288396;0.999999979738056,0.243572941971215,2383.69875844918,3.21697121481965,1.40520032020761,821.540090245516,429.251559076622,47.3080978395302,0.397015305041929,0.939063362027132;0.999999979333683,0.243654691355575,2582.77759658431,3.21750928185822,1.46680053062442,821.607102879544,423.828460157037,41.2913222371256,0.359660144489527,0.957539878861581;0.999999978617460,0.243773837355897,2791.71420047951,3.21919045577302,1.52632462816637,821.666409129631,418.547927377201,36.1458067579581,0.325307861642827,0.975060850192737;0.999999977624672,0.243948197859081,3010.59590710456,3.22179606397968,1.58388206630500,821.718895238120,413.400529361614,31.7259949196448,0.293814067128466,0.991753329620864;0.999999976369736,0.244210773761270,3239.63267348516,3.22512989331970,1.63957114222593,821.765345529415,408.378323331444,27.9145373262021,0.265034030579753,1.00771427970645;0.999999974852371,0.244622518364642,3479.25124290464,3.22902775292364,1.69348013976312,821.806454130894,403.474468232157,24.6159451629395,0.238808117823770,1.02302207332522;0.999999973054927,0.245296127385400,3730.28702429120,3.23335460382426,1.74568875861058,821.842835345840,398.682973331905,21.7519059910264,0.214966863551174,1.03774165983359;0.999999970926186,0.246436216452669,3994.36677786618,3.23799965984378,1.79626939734785,821.875032833597,393.998519995032,19.2577494864323,0.193337499981151,1.05192756435332;0.999999968336508,0.248412865681797,4274.63311318005,3.24287188203529,1.84528822627271,821.903527734465,389.416330087041,17.0797402999266,0.173748989540813,1.06562595574922;1.19999996217058,0.247154748797552,4577.12884955013,3.24789627381054,1.89280607056864,821.928745861433,384.932066732520,15.1729793493968,0.156035489164382,1.07887619988051;1.19999995390920,0.247863768264178,4865.68863498660,3.12480478031496,1.93887913747886,817.151986645016,355.951538705132,-15.7855791175666,-18.5414495167134,1.14133948467536;1.19999993089727,0.248302228244104,5174.22430691113,2.98442056969383,1.97920060933529,812.416875645870,327.742461488251,-42.9935741490367,-25.5883811690010,1.16873799224936;1.19989290999007,0.247172536180070,5498.70706358138,2.84558602861061,2.01337808798748,807.726112525177,300.154271654721,-66.9996128331453,-28.3686966321239,1.18207499696245;1.19735746049967,0.249993177324712,5821.52199241843,2.70954242115028,2.04167315796866,803.086018648829,273.158936321591,-88.1369582356470,-29.3999970704430,1.18702200558140;1.19999996957320,0.245045327542196,6187.70508116533,2.57722699602102,2.06438071291684,798.560222014540,247.049616952529,-106.304389531914,-29.3999950983659,1.18494173214582;1.19999992677365,0.245000029361160,6500.88075538765,2.44369809300092,2.08181748654238,794.026499611197,221.173147269169,-122.518191729022,-29.3999146142053,1.17811717951454;1.19999999910099,0.244953159078697,6831.71915006147,2.31068367145881,2.09412142716197,789.563396133996,195.921698236481,-136.446296542143,-29.0082646541634,1.16575785580625;1.11629693804619,0.245661795675110,7177.54581454611,2.17859944007208,2.10148454346807,785.172000361531,171.287737942416,-148.239548209821,-28.3822317141757,1.14878497684314;1.08370273581900,0.245950423702269,7548.53933878532,2.12353715532282,2.10410644995260,782.664590541462,156.552123896275,-146.933428780157,-20.3538475314864,1.11965163052408;1.07523810456379,0.246064923863204,7930.78213983216,2.10771315519999,2.10476709393519,780.892258237370,145.703134963875,-140.850931958809,-14.2236955186157,1.09922288344183;1.07061213705987,0.246163676274190,8318.95758199085,2.10047286627576,2.10486726001819,779.327617940758,136.011417911860,-133.904948573090,-11.0844716523934,1.08552373781192;1.06793389747420,0.246272507348079,8712.71226151186,2.09422531490590,2.10471785063095,777.886517632481,127.045047513300,-126.825584642849,-9.42644517234428,1.07424475445547;1.06654392278931,0.246387558323547,9112.40624085253,2.08739106401709,2.10436110441630,776.526995034798,118.585985709329,-119.934187139738,-8.47877588941008,1.06404463514433;1.06561157743020,0.246510286361631,9518.25521118731,2.07955779557250,2.10378412304272,775.222175671559,110.493727100321,-113.400450864389,-7.89365366637607,1.05450693189757;1.06386346057791,0.246638052309375,9930.40959264308,2.07085301875022,2.10296042790874,773.962603274379,102.717865903362,-107.259771067234,-7.47648711685928,1.04541870385662;1.05867328642980,0.246773576764025,10348.8824840708,2.06226407407011,2.10186877599735,772.763246576685,95.3332879788919,-101.389943130289,-7.06406133146960,1.03661636827258;1.05765428348202,0.246895139626149,10773.6551443802,2.05666849045271,2.10052221613182,771.686266405628,88.6553790529618,-95.3932990157792,-6.42087225724652,1.02793442126105;1.05743509774712,0.247012888121439,11203.9650848943,2.05111875390974,2.09903118945873,770.652402122719,82.2708673254195,-89.7799184649840,-6.01134813513434,1.02014259817083;1.05723316278579,0.247131132155641,11639.5312913732,2.04465690205316,2.09740216665007,769.646863818190,76.1024233596876,-84.6116469637474,-5.74106452131181,1.01285671248957;1.05720864307475,0.247250150098657,12080.2029721391,2.03733075230397,2.09560882765377,768.669225295141,70.1466976968365,-79.8489785114168,-5.52129268008426,1.00587406217816;1.05721534809608,0.247365962931220,12525.7878524398,2.02919589872764,2.09362737309188,767.716347061928,64.3861878098643,-75.4702451169761,-5.33229408890014,0.999151367700542;1.05736162438974,0.247480410793697,12975.9711930595,2.02038091805905,2.09143670296349,766.787639682506,58.8165500937563,-71.4393767975637,-5.15759078016213,0.992647885515744;1.05757144432374,0.247594382552476,13430.4655953003,2.01092819745614,2.08902080627674,765.880789540685,53.4245586782401,-67.7339240194847,-4.99808847972790,0.986348161629169;1.05787487470320,0.247702512658185,13888.9924880461,2.00090952390993,2.08636565757684,764.994786852456,48.2037551766177,-64.3253219277095,-4.84892085633520,0.980224826653706;1.05823209276948,0.247810794731786,14351.1242450031,1.99037387702483,2.08346014903217,764.128208120528,43.1455658273361,-61.1901293733557,-4.70987538534320,0.974259924177852;1.05871258367060,0.247921571987073,14816.6019400295,1.97938724081141,2.08029521578392,763.280289415199,38.2448387609932,-58.3030610215815,-4.57823489164905,0.968433190922549;1.05928583520403,0.248023772308238,15285.2091895903,1.96797025566880,2.07686434463485,762.449309330282,33.4915245045334,-55.6471220385999,-4.45654614125121,0.962732960273462;1.05998141484220,0.248134555317360,15756.4079167928,1.95615521486212,2.07316194561001,761.634078414827,28.8783771729068,-53.2036491571598,-4.34344893028750,0.957141534848358;1.06069505713045,0.248227513736533,16230.1810181172,1.94395815402796,2.06918371676458,760.833090970689,24.3965776463912,-50.9576993560569,-4.23953241931753,0.951645628800965;1.06152784754367,0.248326480340035,16705.6943663370,1.93145085691637,2.06492604763153,760.046298368150,20.0448414165064,-48.8869236422627,-4.13946782149540,0.946226821456183;1.06247127935085,0.248424239022155,17182.9180587035,1.91865109950413,2.06038789114722,759.272372674075,15.8153117492919,-46.9791564336017,-4.04625502496856,0.940880721584329;1.06358212494328,0.248519677494232,17661.5438902071,1.90557357176205,2.05556884023135,758.510187068110,11.7012349733024,-45.2222449441661,-3.95994933307971,0.935596737022721;1.06457309294447,0.248615214352845,18141.2309291751,1.89220463041793,2.05046900110340,757.758031557932,7.69293271244807,-43.6087888891448,-3.88257786094053,0.930366571191280;1.06585863500094,0.248688888371064,18621.7294426839,1.87867373159469,2.04508801250009,757.017640200375,3.79846231412040,-42.1112075630698,-3.80209636410491,0.925169242887538;1.06711628699460,0.248800324017729,19102.0555834027,1.86491338907101,2.03942992694931,756.285973841106,0.00131281262564853,-40.7341284741011,-3.73229211878459,0.920018756562794;1.06891275039717,0.248886906359799,19583.3711429543,1.85099306587582,2.03349636466144,755.563748215309,-3.69560024988409,-39.4586981307532,-3.66347490621928,0.914893491508835;1.06969054262184,0.248947742794158,20064.3829311049,1.83673541798480,2.02729125250273,754.845688010426,-7.32008608571318,-38.3044667437192,-3.61438862101808,0.909805954570581;1.07220207111017,0.249061720508298,20544.0204891718,1.82264701556226,2.02081235412912,754.142747709545,-10.8165148386445,-37.1901771074749,-3.53186084080583,0.904695071755358;1.07586695588026,0.249126586449943,21024.1494427641,1.80807117144426,2.01407473261785,753.437971023340,-14.2728922000573,-36.2137692837220,-3.50113678171344,0.899662442660393;1.11010926757130,0.249205036461077,21502.4952106021,1.79254004850875,2.00707061153795,752.721493163317,-17.7397279929330,-35.4169886099962,-3.52030390888978,0.894634539235076;0.973853871201850,0.249307592176215,21979.4908947578,1.76376038316425,1.99977657239495,751.715646548440,-22.6373536198826,-36.4483398025710,-4.54132088044914,0.890105210564149;1.13864899698519,0.249164023346557,22457.5897830566,1.78858803860256,1.99175202196111,751.946787502780,-21.1337778364793,-29.8567556722444,-0.410660408339423,0.881121147008476;1.08813768807249,0.249256142754763,22920.9066383199,1.75494839441100,1.98484444652692,750.762707977888,-26.8905210860996,-32.6831592025155,-4.29190457228325,0.882361923437295;1.08749951516408,0.249181551404163,23387.4452148881,1.73448451785547,1.97702798075498,750.035335245880,-30.2284007012449,-32.3607027855294,-3.72130420387016,0.875367265546835;1.08886274523870,0.249026281998930,23847.6144865897,1.71775111492993,1.96878150301640,749.337586401723,-33.3633573585938,-31.8694351079999,-3.44303963108425,0.869673195970726;1.18046853207660,0.248569145815902,24298.5739980624,1.70198256925851,1.96024646982146,748.653038275425,-36.3823229366938,-31.3399719780281,-3.30666913626512,0.864373661943956;1.02582989815656,0.248154505982879,24728.7689181562,1.65614462836391,1.95146549720232,747.310318375605,-42.7216819809741,-34.8149454117057,-5.55744356902123,0.860205192834490;0.874677078672945,0.246882146157691,25147.4568969189,1.66111762110578,1.94142458766181,747.124853028156,-43.0444727823187,-30.8032439477912,-2.08685082736187,0.850308244867636;1.00012243276783,0.244494767652997,25514.8121312262,1.71786362493766,1.93189415079891,747.993723847573,-37.9613223638049,-21.0049523593797,2.47961435579843,0.844650411358012;1.19999955311231,0.244688307182446,25788.5062217540,1.73638550099828,1.92461711291962,747.992961343085,-37.3987135841662,-17.8645269635642,0.624076624666267,0.847869729047662;1.19999973523616,0.247052014805876,26108.6355052353,1.69024204898535,1.91821723811430,746.704857173469,-43.4323292562017,-22.9278775168534,-4.29977500657122,0.849718189276949;1.19999982859073,0.249710850595572,26565.3247646517,1.64024539387048,1.91046608168391,745.463395438012,-49.1391287323347,-26.9640337650087,-5.39758398798552,0.843029206668814;1.16454862952458,0.250319532313877,27136.0878881633,1.59485245244706,1.90127857829826,744.265099927248,-54.5343332756569,-30.1063310414744,-5.49542927355634,0.834879688490311;1.14754874451367,0.250369557050287,27695.7373706735,1.56359807766561,1.89086009001932,743.312379710889,-58.5843641802239,-31.2595227200567,-4.63708810215169,0.826352631934667;1.14908941217619,0.250334720389904,28219.2019621922,1.54088221278057,1.87973318159929,742.487033938479,-61.9123255229554,-31.4259092759740,-3.95423966023784,0.819024649113306;1.14311525594578,0.250237501034857,28710.5000670399,1.52015695968767,1.86821224865945,741.681726881113,-65.0783726506051,-31.4039466420963,-3.69299194017508,0.812565174731844;1.16250226521913,0.249862560097105,29174.0789346699,1.50235827179260,1.85637836883441,740.935572343695,-67.8850420541202,-30.9932377285537,-3.40779093111425,0.806260689619202;1.17190781320859,0.249092463186080,29602.2046222620,1.48134488231470,1.84434168553499,740.118090698554,-71.0045371170995,-31.0351369811495,-3.55984748653071,0.800330137180719;1.17590433472576,0.247356738558301,29983.4814206609,1.45922178412475,1.83199979422550,739.284007547330,-74.1517701379438,-31.1336988872924,-3.63132631066613,0.794017818860054;0.819733608387544,0.245194791192726,30279.8016578472,1.43775226463373,1.81932534188208,738.461261884336,-77.1820103405873,-31.1101196515036,-3.58812456340010,0.787509587545137;0.387420151642912,0.258278145695364,30490.1650907097,1.49387005166050,1.80635185725563,739.273384841453,-71.7950508472636,-21.2990252975605,1.87868128942203,0.780040220233702;0.881742348542949,0.258278145695364,31420.0917396135,1.63411856785251,1.79572747586540,741.929220253047,-57.0578226712186,-2.04140900721400,9.20412201761893,0.778658577777029;1.05787874741696,0.258278145695364,32185.5380961010,1.67562773609073,1.79023277299296,742.426089067646,-53.5945797892471,1.24848206216104,3.71138365664191,0.791902775357113;0.714450940231285,0.258278145695364,32839.7861823072,1.66933304120873,1.78633620173828,742.190850176210,-53.9447111550307,-0.353505933723371,0.0715576671797233,0.796571241276110;1.19994014504069,0.258278145695364,33417.7405274927,1.71727809318206,1.78235809428028,743.312365178727,-47.3568354999741,6.39763017494488,3.76843714107569,0.793119633087732;0.133817569940483,0.258278145695364,33932.3344407333,1.68821577164358,1.78014537424294,742.554134636753,-50.4814852099192,0.857831262140828,-1.65931912685249,0.800059178282022;1.16615779350306,0.258278145695364,34409.4946641489,1.81791421016517,1.77701976775456,745.724010217004,-33.4774068760002,19.6534082442149,10.2415537271602,0.789161467155361;0.842673192676497,0.258278145695364,34838.2160171476,1.80160099966349,1.77841017879652,745.137430477468,-35.9420971816718,13.0222230513679,0.397858030281509,0.807619326328509;1.19494963348645,0.258278145695364,35248.9071776694,1.81487729505447,1.77919866670600,745.673001645101,-32.6424889331730,14.1913459563673,1.89980537463238,0.806030693876643;0.627292015954975,0.258278145695364,35640.9031005153,1.78361803931750,1.78041174006985,745.033164790948,-35.4041771085224,8.14963557818993,-1.70498011981443,0.810602589735644];
    otherwise % dice solution
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
end

% adjust guess for timestep
guess = interp1([1:guessed_timestep:guessed_horizon]',guess,[1:Params.timestep:Params.numyears]','linear','extrap');
clear guessed_timestep;

% store columns for guess
Params.col_abaterate = 1;
Params.col_savingsrate = 2;
if strcmp(Params.carbonmodel,'fair')
    Params.col_alpha = size(guess,2);
end

% vector of controls for obtaining feasible starting guess
if Params.optimizeonlysavings==1
    guess(:,Params.col_abaterate) = 0;
end
if Params.dicefirstperabate==1
    guess(1,Params.col_abaterate) = Params.fixabate1;
end
if Params.fixsavings>=0
    policyguess = guess(:,Params.col_abaterate);
else
    policyguess = [ guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
    if Params.dicelrsavings==1
        policyguess(end-round(5*10/Params.timestep)+1:end,:) = [];
    end
end
if strcmp(Params.carbonmodel,'fair')
    policyguess = [ guess(:,Params.col_alpha); policyguess ];
end
% ensure starting trajectory is feasible
[ C, ~, K, T, M, ~, Tocean, ~, ~] = trajectory( policyguess, 1, Params.horizon, Fun, Params );
if Params.fixsavings>=0
    guess(:,Params.col_savingsrate) = Params.fixsavings*ones(size(guess,1),1);
end
% store feasible guess
if strcmp(Params.carbonmodel,'fair')
    if Params.consumptionascontrol
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) C K T Tocean M guess(:,Params.col_alpha)];
    else
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) K T Tocean M guess(:,Params.col_alpha)];
    end
else
    if Params.consumptionascontrol
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) C K T Tocean M ];
    else
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) K T Tocean M ];
    end
end

% store further columns for guess
if Params.consumptionascontrol
    Params.col_C = 3;
    Params.col_K = 4;
else
    Params.col_C = [];
    Params.col_K = 3;
end
Params.col_T = Params.col_K+1;
Params.col_Tocean = Params.col_T+1;
Params.col_M = [Params.col_Tocean+1:Params.col_Tocean+size(M,2)];
if strcmp(Params.carbonmodel,'fair')
   Params.col_alpha = size(guess,2);
end

clear C K T Tocean M;


%% Set up variable bounds

lb = zeros(size(guess,1),size(guess,2)); % all nonnegative
ub = Inf*ones(size(guess,1),size(guess,2));

% bounds on control variables
ub(:,Params.col_abaterate) = Params.bound_abate;
ub(:,Params.col_savingsrate) = 1; % savings rate cannot rise above 1

% fix abatement controls where appropriate
if Params.optimizeonlysavings==1
    lb(:,Params.col_abaterate) = 0;
    ub(:,Params.col_abaterate) = 0;
    disp('Constraining abatement to be zero');
end
if Params.dicefirstperabate==1
    lb(1,Params.col_abaterate) = Params.fixabate1;
    ub(1,Params.col_abaterate) = Params.fixabate1;
    disp(['Fixing first-period abatement at ' num2str(Params.fixabate1)]);
end

% bounds on state variables (for stability)
if Params.consumptionascontrol
    lb(:,Params.col_C) = 2; % consumption
end
lb(:,Params.col_K) = 1; % capital
lb(:,Params.col_T) = -1; % surface temperature
ub(:,Params.col_T) = 12; % surface temperature
lb(:,Params.col_Tocean) = -1; % ocean temperature
ub(:,Params.col_Tocean) = 20; % ocean temperature
switch Params.carbonmodel
    case 'dice'
        lb(:,Params.col_M) = bsxfun(@times,ones(Params.horizon,1),[0.5*588 100 1000 ]); % carbon sinks
    otherwise
        lb(:,Params.col_M(1)) = ones(Params.horizon,1)*0.5*588; % permanent sink
        lb(:,Params.col_M(2:end)) = bsxfun(@times,ones(Params.horizon,1),-7*Params.M0(2:end));
end
if strcmp(Params.carbonmodel,'fair')
    lb(:,Params.col_alpha) = 0.1;
    ub(:,Params.col_alpha) = 1000; % for stability - Millar et al. 2017 pg 7216 use 100 but Dietz et al use 1000
end


%% Adjust if solving by simulating trajectory conditional on policy

if Params.transitionsasconstraints~=1

    % initial guess vector: abatement rate, savings rate, and possibly alpha
    if Params.fixsavings>=0
        if ~strcmp(Params.carbonmodel,'fair')
            guess = guess(:,Params.col_abaterate);
            ub = ub(:,Params.col_abaterate);
            lb = lb(:,Params.col_abaterate);
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate) ];
        end
    else
        if ~strcmp(Params.carbonmodel,'fair')
            guess = [ guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        end
        if Params.dicelrsavings==1 % don't guess these fixed savings variables
            guess(end-round(5*10/Params.timestep)+1:end,:) = [];
            ub(end-round(5*10/Params.timestep)+1:end,:) = [];
            lb(end-round(5*10/Params.timestep)+1:end,:) = [];
        end
    end     
    
end


%% Scale variables around guessed path

if Params.scalevars
    Params.normalization = guess;
    Params.normalization(Params.normalization < 1e-5) = 1;
elseif Params.transitionsasconstraints
    Params.normalization = ones(size(guess));
else
    Params.normalization = 1;
end

guess = guess./Params.normalization;
ub = ub./Params.normalization;
lb = lb./Params.normalization;