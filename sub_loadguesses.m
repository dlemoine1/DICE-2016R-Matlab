% Initial guesses and bounds for DICE-2016R

% Last edited: July 24, 2021 by Derek Lemoine

% guess columns need to be ordered abatement rate, savings rate (if endogenous),
% and final column alpha (if using FAIR)
guessed_timestep = 5; % timestep used for guess
guessed_horizon = 500;
switch Params.carbonmodel
    case 'dice' % from dice climate module
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
    case 'joos' % from updated climate module
        guess = [0.138766025229609,0.261355650778958,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000;0.158232121541979,0.257774927155944,268.828540714191,1.25405498137236,0.0354688000000000,737.270309563312,99.5620136317820,38.6823878903873,14.2462912181536;0.178861598852014,0.254902080853013,319.767594268416,1.46041047635746,0.0769007301666603,748.109972844115,109.497577625119,47.8218212693349,18.2418726789481;0.200964816637435,0.252529028729608,376.314258426531,1.60934494478798,0.123940061537148,759.546932641082,119.925279420483,56.5685209373469,20.2519604459386;0.224669301034988,0.250538405760977,438.804819499663,1.74086001542456,0.174443827567676,771.496536625502,130.751735567444,64.8627062139489,21.5329521292936;0.250047735640455,0.248866040449451,507.482281894394,1.86604847162159,0.227701977954810,783.863053580480,141.873303603822,72.6378446519579,22.4640131769912;0.277159596003813,0.247468359224984,582.554140360052,1.98766250088227,0.283405758739481,796.541415941623,153.178005922107,79.8237801978931,23.1519510646340;0.306063215083351,0.246311761156828,664.217016651131,2.10606428343167,0.341350487972335,809.419183448169,164.547657635402,86.3497485995627,23.6208220415808;0.336819702492889,0.245367705910178,752.667333695670,2.22095458204246,0.401350757017952,822.378434279465,175.859893227239,92.1469128913929,23.8711858327349;0.369492561806846,0.244611604263574,848.104640410563,2.33187556369268,0.463217287068786,835.297463582024,186.989969446461,97.1503242680907,23.8984074526293;0.404147530090185,0.244021789324438,950.733081643521,2.43835526483681,0.526751668473998,848.052285517604,197.812343241315,101.300376813045,23.6981358468297;0.440850987635811,0.243579163121350,1060.76131386003,2.53994604599294,0.591746190750334,860.517936531254,208.202025158752,104.543817829189,23.2677659549315;0.479666779476185,0.243266547303468,1178.40213927376,2.63623130848755,0.657984985828583,872.569623776209,218.035756293171,106.834427712320,22.6066994509670;0.520655917790238,0.243068130516818,1303.87119983451,2.72682282988436,0.725245360798987,884.083781541215,227.193075762564,108.133493307062,21.7163093789564;0.563873327464842,0.242968645352291,1437.38468548856,2.81135501626079,0.793298994747890,894.939000263111,235.557243564439,108.410055132205,20.5997670741925;0.609362949091072,0.242952144896615,1579.15500368478,2.88947863034458,0.861912899479328,905.016912434589,243.016107519714,107.641066966493,19.2619331812355;0.657155326911083,0.243000223532880,1729.38256591527,2.96085500816073,0.930850134328747,914.203095123787,249.462976557877,105.811556611201,17.7093446647114;0.707289730067529,0.243088350537410,1888.24069906153,3.02515059672562,0.999870300039034,922.387950500801,254.797460469339,102.914737508625,15.9501827791924;0.760040062044353,0.243260018167180,2055.84433359731,3.07067483993115,1.06872983012638,929.466989666827,258.925684117929,98.9513306246545,13.9935043346887;0.815541400018391,0.243445348180264,2232.69316212182,3.10518985309622,1.13679596045974,935.335579939161,261.754791736946,93.9217778511016,11.8419612891817;0.873901372147837,0.243583665539123,2418.86412092860,3.13045924395660,1.20372135280938,939.892790550802,263.196898524466,87.8312755171460,9.50109074320877;0.935255145518280,0.243582445853032,2614.14052418563,3.14660498040351,1.26923044110839,943.041913043650,263.169565254639,80.6898425725041,6.97799453407991;0.999773192358015,0.243277968712922,2817.85518283352,3.15326255756613,1.33306117544442,944.690130357653,261.595389433683,72.5112737070209,4.27984350387357;0.999999918661969,0.243540092778766,3028.47238448467,3.14987706895579,1.39494802243656,944.748193785279,258.401609648767,63.3122365923094,1.41341933623568;0.999999952716746,0.243767709826696,3251.97143822708,3.14770231029619,1.45461561001821,944.794645527795,255.235583290716,55.2747044608768,0.501464247394265;0.999999963175748,0.243987339273607,3487.36200130518,3.14768003101845,1.51218055782766,944.835754711029,252.103427593422,48.2582632290396,0.209229196086027;0.999999967356903,0.244233630928788,3734.00648848403,3.14929735247069,1.56778753991615,944.872136212547,249.005355121312,42.1331101814551,0.111748321177564;0.999999967946070,0.244550306671658,3991.66677611387,3.15209769975791,1.62155887354300,944.904333839589,245.941502533375,36.7859525515880,0.0759169554839950;0.999999962244638,0.245005533179357,4260.52979887998,3.15578976998012,1.67359719363431,944.932828812679,242.911940272434,32.1179068553036,0.0599937627538522;1.13943690167674,0.244236030186500,4541.37645181468,3.16018203777023,1.72399174123007,944.958047085850,239.916680934648,28.0426653965834,0.0508434340266005;1.09656007399470,0.244701413044485,4818.96160871025,3.14013727561604,1.77282221131243,941.642383911357,233.514784924542,20.1469022081675,-4.19999827152522;1.09748281783550,0.244872672353350,5113.42972868793,3.12677096061854,1.81931092349876,939.373121328224,228.271177703414,14.6209275691465,-4.19999854357684;1.09853101849317,0.245025907222613,5418.57826945692,3.11568164355146,1.86376456476083,937.103858801837,223.092788723884,9.80174829825269,-4.19999855657656;1.09970664914551,0.245171641606228,5733.70306731418,3.10559606388611,1.90632974543971,934.834596288220,217.978806778562,5.59896225129925,-4.19999854440803;1.10101027439183,0.245314102257195,6058.36379357732,3.09609093781299,1.94710480026689,932.565333796511,212.928430804331,1.93373016589270,-4.19999851274273;1.10244213281793,0.245454895837588,6392.23345831685,3.08698069457214,1.98617032894346,930.296071334611,207.940869700143,-1.26270335019739,-4.19999846492951;1.10400256319914,0.245594582545488,6735.03464845746,3.07815225628161,2.02359788137483,928.026808909783,203.015342203735,-4.05029958747454,-4.19999840282674;1.10569217440058,0.245733217114559,7086.51098346851,3.06951982520644,2.05945273012166,925.757546528931,198.151076769548,-6.48135053678619,-4.19999832747193;1.10751191771178,0.245870942010196,7446.41208956283,3.06101193544460,2.09379501135454,923.488284198821,193.347311448098,-8.60145982457611,-4.19999823936571;1.10946309478152,0.246007690258190,7814.48996455611,3.05256722774168,2.12668038677361,921.219021926272,188.603293766819,-10.4503981824505,-4.19999813859976;1.11154737363638,0.246142845676091,8190.49260813516,3.04413263012950,2.15816053936652,918.949759718285,183.918280612330,-12.0628494986787,-4.19999802496934;1.11376681657492,0.246276982149269,8574.15380896029,3.03566224710017,2.18828359045246,916.680497582147,179.291538114134,-13.4690614466210,-4.19999789804536;1.11612379228586,0.246409577370294,8965.21169982773,3.02711649872822,2.21709446477848,914.411235525519,174.722341529745,-14.6954128950796,-4.19999775721998;1.11862104754423,0.246540041420038,9363.38866827337,3.01846138295653,2.24463521393278,912.141973556520,170.209975131251,-15.7649087444884,-4.19999760171964;1.12126169657773,0.246669124422714,9768.39101277417,3.00966782298996,2.27094530367958,909.872711683814,165.753732093277,-16.6976114714841,-4.19999743061053;1.12404912095477,0.246796050584402,10179.9338553706,3.00071108544007,2.29606186933614,907.603449916677,161.352914382329,-17.5110174771408,-4.19999724282116;1.12698707968792,0.246920336984652,10597.7108601092,2.99157026125347,2.32001994268367,905.334188265105,157.006832647558,-18.2203852986391,-4.19999703710022;1.13007967372850,0.247044117114011,11021.4022540218,2.98222780329492,2.34285265351504,903.064926739907,152.714806112861,-18.8390218413090,-4.19999681202355;1.13333115655149,0.247164384692924,11450.7283927581,2.97266911513963,2.36459140860756,900.795665352637,148.476162470161,-19.3785320006016,-4.19999656619690;1.13674633242191,0.247283214248495,11885.3374800434,2.96288218604801,2.38526605062965,898.526404115839,144.290237774339,-19.8490363559632,-4.19999629792635;1.14033013576442,0.247399909981283,12324.9251295232,2.95285726745359,2.40490499923387,896.257143043259,140.156376339437,-20.2593610207882,-4.19999600515112;1.14408787682163,0.247514248309594,12769.1655259635,2.94258658665339,2.42353537635334,893.987882149749,136.073930635831,-20.6172032101772,-4.19999568582295;1.14802519348156,0.247627434519570,13217.7259775895,2.93206409375604,2.44118311750355,891.718621451515,132.042261189045,-20.9292756314297,-4.19999533757802;1.15214793827063,0.247738260343918,13670.3020796143,2.92128523828088,2.45787307069613,889.449360965978,128.060736479421,-21.2014324068934,-4.19999495812963;1.15646239578374,0.247849412591016,14126.5548317604,2.91024677215194,2.47362908439401,887.180100712314,124.128732843730,-21.4387788898767,-4.19999454453239;1.16097493949982,0.247960919289046,14586.2152004505,2.89894657611690,2.48847408577778,884.910840710062,120.245634376032,-21.6457674371499,-4.19999409540148;1.16569230518853,0.248073655728726,15049.0045921151,2.88738350700396,2.50243015044931,882.641580982959,116.410832835133,-21.8262809249577,-4.19999360496912;1.17062150920454,0.248191334117535,15514.6610972086,2.87555726333421,2.51551856457217,880.372321555749,112.623727545978,-21.9837055921017,-4.19999307014504;1.17576960051984,0.248321727448283,15983.0165606104,2.86346826725493,2.52775988033008,878.103062454840,108.883725306214,-22.1209945611028,-4.19999248784959;1.18114333145186,0.248473546443176,16454.0978843056,2.85111756089318,2.53917396548552,875.833803710841,105.190240295867,-22.2407232322841,-4.19999185177429;1.18674916014836,0.248666127598083,16928.1252854271,2.83850671536845,2.54978004772938,873.564545355265,101.542693982122,-22.3451376003119,-4.19999115879823;1.19259227319154,0.248930377296159,17405.8034131861,2.82563775107282,2.55959675442911,871.295287423333,97.9405150315778,-22.4361963829077,-4.19999040322604;1.19867583870003,0.249324142319582,17888.6015228618,2.81251306781159,2.56864214831500,869.026029953376,94.3831392200866,-22.5156077655583,-4.19998957932531;1.19999937713554,0.249349110953974,18379.4825355285,2.79913535901482,2.57693375957788,866.756770431773,90.8700067104917,-22.5848647661515,-4.19999193014158;1.19999930099904,0.249390306634634,18864.8339522763,2.78604458709285,2.58448861395874,864.542848820953,87.4576134765373,-22.5733471418819,-4.12962973566813;1.19999921479204,0.249439708466813,19346.4843742901,2.77341687226427,2.59134151704530,862.398136727114,84.1590058664964,-22.4733589626870,-4.01960549890178;1.19999911721745,0.249493690430518,19825.4210334000,2.76122338395031,2.59753207912274,860.321251224441,80.9713430884178,-22.2980132137680,-3.89892545381338;1.19999900656730,0.249549968955257,20302.1827387386,2.74942193123438,2.60309758348688,858.310727216988,77.8917349794658,-22.0588524617492,-3.77677303113560;1.19999888109768,0.249606751342147,20777.0240950669,2.73798085221273,2.60807261131030,856.365047334706,74.9172734377853,-21.7660108653408,-3.65608911163912;1.19999873867054,0.249663082411493,21250.0063640282,2.72687665433702,2.61248949150098,854.482661760585,72.0450530840982,-21.4283685495270,-3.53783544766875;1.19999857672283,0.249719441450964,21721.0781303122,2.71609052699803,2.61637865503740,852.662002218343,69.2721856468084,-21.0536938235338,-3.42233653890066;1.19999839242456,0.249774546628596,22190.1595732185,2.70560641513736,2.61976885868407,850.901491649442,66.5958097246071,-20.6487728106078,-3.30970512048676;1.19999818249982,0.249828374697401,22657.0866481096,2.69541009893643,2.62268733560348,849.199550464865,64.0130968968126,-20.2195269489898,-3.19997969606245;1.19999794267449,0.249880821449989,23121.6822262201,2.68548876231595,2.62515990955680,847.554603245141,61.5212582197709,-19.7711148814936,-3.09316701562921;1.19999766730432,0.249932313345300,23583.7588904768,2.67583074493069,2.62721109055061,845.965082965731,59.1175480915231,-19.3080245289823,-2.98925851766286;1.19999735175292,0.249979047358349,24043.1454451943,2.66642537675359,2.62886415879953,844.429434674026,56.7992675031050,-18.8341540999415,-2.88823617277977;1.19999698907131,0.250026299391333,24499.5117696520,2.65726284729593,2.63014124020997,842.946118220288,54.5637662741857,-18.3528839680663,-2.79007551572405;1.19999657248486,0.250071073813360,24952.7856455184,2.64833412993825,2.63106337485089,841.513613816901,52.4084481764137,-17.8671356807750,-2.69474299814530;1.19999609212377,0.250112891317637,25402.7452337140,2.63963084511773,2.63165058052386,840.130419591135,50.3307677396840,-17.3794338254110,-2.60220534038682;1.19999553597985,0.250148500207339,25849.1640760821,2.63114520732725,2.63192190952005,838.795056474391,48.3282346608246,-16.8919504480975,-2.51242313014170;1.19999489102716,0.250174658995687,26291.6913073582,2.62286996096777,2.63189550164550,837.506069973214,46.3984149430676,-16.4065478436539,-2.42535278371749;1.19999413797556,0.250190681965171,26729.8805080965,2.61479833881353,2.63158863326246,836.262033379076,44.5389335044756,-15.9248140026992,-2.34094533049753;1.19999325642446,0.250185631615323,27163.3265226029,2.60692402063598,2.63101776325119,835.061549957007,42.7474757012962,-15.4480948519909,-2.25914733087935;1.19999222930264,0.250139574163255,27591.1814221525,2.59924107555539,2.63019857600228,833.903252875975,41.0217865044826,-14.9775253058864,-2.17990403499425;1.19999101643104,0.250029656040529,28011.8309555699,2.59174397220024,2.62914602098708,832.785811028033,39.3596757568004,-14.5140486932257,-2.10315288372707;1.19998953325942,0.249816380894287,28422.9220843931,2.58442762668297,2.62787435132833,831.707937277048,37.7590258690277,-14.0584305419997,-2.02881838530342;1.19998776293853,0.249407272627455,28820.7143745593,2.57728743100281,2.62639716269039,830.668394351248,36.2177969916181,-13.6112736629435,-1.95681350756257;1.19998562687133,0.248673692919031,29197.7896228764,2.57031932841925,2.62472743181301,829.666005199094,34.7340367229732,-13.1730255034136,-1.88703443856878;1.19998303741582,0.247357705678103,29542.0812035350,2.56352011118909,2.62287755629762,828.699683742716,33.3059107234469,-12.7439580522886,-1.81933301089615;1.19997977627248,0.245033629274380,29831.4289889777,2.55688774374477,2.62085940316393,827.768466635835,31.9317339840513,-12.3241490096888,-1.75350679319915;1.19997557650639,0.258278145695364,30027.4121344311,2.55042211379630,2.61868436674368,826.871586301071,30.6100442583874,-11.9134117190838,-1.68924350157650;1.19997031518853,0.258278145695364,30949.4242759583,2.54412618025107,2.61636345014347,826.008579507094,29.3397112169134,-11.5111878742785,-1.62605841089978;1.19996326227523,0.258278145695364,31723.1375553876,2.53793042398059,2.61390738296713,825.172215002155,28.1126418902841,-11.1257862021853,-1.57240543517855;1.19995339721622,0.258278145695364,32387.7456304703,2.53184313909497,2.61132416636158,824.362992220589,26.9288130126628,-10.7544060186954,-1.52110097335215;1.19993900621875,0.258278145695364,32971.9651598968,2.52587653067617,2.60862181143452,823.580934512486,25.7877108442600,-10.3952235712596,-1.47050190632799;1.19991622735907,0.258278145695364,33496.6967012205,2.52003746474706,2.60580847188874,822.825756899555,24.6885101999487,-10.0470490721116,-1.42048598175117;1.19987627399287,0.258278145695364,33977.0832969545,2.51432874672666,2.60289225764592,822.096983999889,23.6301998836510,-9.70909235816172,-1.37125703550773;1.19978607012923,0.258278145695364,34424.0620879150,2.50875102745655,2.59988109827466,821.394040062866,22.6116778128192,-9.38079476924714,-1.32300648845307;1.19944986447605,0.258278145695364,34845.5152228470,2.50330473395784,2.59678267586685,820.716377438047,21.6318845788244,-9.06163258157869,-1.27575852553043;0.00155866578003304,0.258278145695364,35247.1146861352,2.49799628657043,2.59360442584194,820.064026926239,20.6903702361999,-8.75039731079572,-1.22878520775116];
    case 'fair' % from updated climate module
        guess = [0.264267211501918,0.258870830001891,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000,0.380703525630311;0.300932268357429,0.255604565628346,267.267048519782,1.38968111057360,0.0354688000000000,735.900678949681,131.852529003469,68.4024318729773,17.6672004005282,0.424182193393157;0.338748493327599,0.252961365925112,316.692178403252,1.73037998508310,0.0815120185595024,745.003761491101,174.186751163203,100.072285323367,20.9077022606272,0.448569718370865;0.378851245414876,0.250832122875717,371.604615683206,1.99403109967998,0.137573529421305,754.306177889347,216.598113325284,125.822955623351,22.6912690540782,0.466051056146424;0.421869206567317,0.249133305827483,432.286270825462,2.21889635273189,0.200693086810099,763.681060001044,258.442724049923,146.556900960462,23.8098893309583,0.482408612535027;0.468258871737758,0.247815694084749,498.977876562845,2.41804287623032,0.269311997851440,772.982870521223,299.045165780335,162.941899874523,24.4898077448316,0.499559163723002;0.518444599835464,0.246842810104553,571.916740917699,2.59631223228189,0.342368847716322,782.050148603054,337.683736894232,175.390120461316,24.7596697850823,0.518274421014296;0.572853227874448,0.246179594212520,651.353720364662,2.75542508604565,0.419002922791552,790.707081883791,373.586577142440,184.080686334075,24.5756114063485,0.539022384130367;0.631916650499746,0.245783907430135,737.554051163951,2.89562264740014,0.498441276342191,798.764662496630,405.931992594833,189.000009097760,23.8621774989846,0.562223911109484;0.696018808735196,0.245589269735346,830.782071593945,3.01622997720110,0.579945442958161,806.021728242495,433.850056294539,189.977388136986,22.5229413633484,0.588334133765445;0.765457396420479,0.245486045218729,931.250676600013,3.11585272450661,0.662779117122421,812.266960771311,456.429187017937,186.714764239241,20.4431318640808,0.617862752326884;0.840381392731449,0.245283239707275,1039.02080996891,3.19241062226709,0.746183619773483,817.281794094850,472.726618546824,178.808987128580,17.4886051764286,0.651369147283680;0.920680509380913,0.244641151612909,1153.79549466221,3.24307993954698,0.829355337858266,820.844978394017,481.786313758724,165.773014763724,13.5060711787045,0.689429661739471;0.999999892334260,0.243206254139349,1274.51064214368,3.26418099224049,0.911421974315682,822.740219668782,482.671524247645,147.066704501760,8.32922351284360,0.732555270415816;0.999999992327293,0.243411157668791,1399.42169317713,3.25373467317655,0.991415780925126,822.897820017726,475.181067966140,122.915548166737,2.20807025800353,0.779951268885279;0.999999995360507,0.243494050122125,1536.83999719185,3.24726138283202,1.06833462326167,823.037294387992,468.219368662054,103.946228051981,0.958989509952251,0.815800065305435;0.999999996325975,0.243500841899383,1685.57753065393,3.24731120024927,1.14241813308707,823.160729158939,461.618064492304,88.6155434553262,0.649282590553471,0.847772798442096;0.999999996731335,0.243462440631582,1844.78339074491,3.25257844122777,1.21398449737058,823.269968922619,455.313210325002,76.0479143953507,0.543009511719020,0.877531631228668;0.999999996894521,0.243474427333523,2013.88476560316,3.25045072160337,1.28329669146173,823.366646114904,449.265885019797,65.6373221279725,0.485231071762710,0.901834795456849;0.999999996918195,0.243505047277512,2192.99802105619,3.24807952168266,1.35017992848654,823.452205435931,443.421378056700,56.9024121733769,0.439631471133714,0.923631719250245;0.999999996839949,0.243552542369248,2382.02693457019,3.24698262110323,1.41470851465521,823.527925443686,437.753632091429,49.5156128341005,0.398913045650936,0.943861595437950;0.999999996670340,0.243619372695304,2580.88732273691,3.24727731860742,1.47700583427444,823.594937661525,432.246026765740,43.2310671211030,0.361554980708402,0.962896644987724;0.999999996403209,0.243709919602986,2789.54102023541,3.24877104064322,1.53719506474176,823.654243487671,426.886070962063,37.8569339375684,0.327190038098048,0.980934641603597;0.999999996016097,0.243829638217170,3008.00161756522,3.25123433582274,1.59538864792241,823.706729159959,421.663646667014,33.2406428607230,0.295657659826588,0.998108843372188;0.999999995463097,0.243992903807792,3236.33348150625,3.25446272387035,1.65168740131102,823.753178999676,416.570254943656,29.2593574695040,0.266815901777024,1.01452121189947;0.999999994654909,0.244222270596123,3474.70276785173,3.25828551189538,1.70618176227804,823.794287132581,411.598597896336,25.8132346559099,0.240511385399711,1.03025419719229;0.999999993405830,0.244559790453646,3723.42951640817,3.26256245806090,1.75895328976503,823.830667862544,406.742305068332,22.8204638142054,0.216580509544282,1.04537610664772;0.999999991269999,0.245088674154614,3983.12874455322,3.26717855849805,1.81007600148709,823.862864853594,401.995738907337,20.2135337425170,0.194855219907808,1.05994425494234;0.999999986871451,0.245957877014626,4255.03088967486,3.27203931932358,1.85961748842546,823.891359260190,397.353850959477,17.9363798436421,0.175168086604632,1.07400714599006;1.19999995441762,0.244868540131124,4541.52554116081,3.27706688931216,1.90763983067600,823.916576939135,392.812073403111,15.9421770387494,0.157356029449939,1.08760611354427;0.908898457480998,0.248858790261307,4818.65118284994,3.15529299927276,1.95420035066963,819.151047452566,363.832401688098,-15.0397758462302,-18.5630436014989,1.15120585705131;1.19999999384093,0.246547065389132,5156.03259912356,3.20885115303349,1.99503750072213,821.330372331791,371.011561922581,-0.00142716864991144,1.95791545654631,1.10835080287138;1.19999999297183,0.246334089880954,5459.96005690597,3.09793950054898,2.03630716490072,816.644579872227,342.771097424429,-28.6426140136247,-17.7711205083187,1.17416959023167;1.19999999135359,0.246150496445519,5775.17556837292,2.96115095831446,2.07240266431276,812.011863379026,315.334494897025,-53.9014798497877,-25.3079576904775,1.20019678566086;1.19999998657178,0.246237991765261,6102.19469535548,2.82449035816501,2.10262010630882,807.436302861854,288.556486210354,-76.1844376921526,-28.2506145098611,1.21097307744847;1.19945803471844,0.247814620815073,6443.15923227265,2.69084712878795,2.12716369487193,802.921518180500,262.397733954506,-95.7733235693465,-29.2805125047426,1.21328012126243;1.19999998903406,0.247758254262948,6814.73404805284,2.55981878042057,2.14632893162507,798.482458166452,236.905095879694,-112.822876540246,-29.3999991234818,1.20917957450877;1.19999998739172,0.247726733550671,7191.88988002664,2.42969167400022,2.16038758648412,794.094347935831,211.931220899524,-127.695252220292,-29.1763003324184,1.19991813483046;1.19999998540553,0.247707360199814,7575.51706390166,2.30050978228894,2.16954392545967,789.773629310269,187.547699383448,-140.449483855909,-28.6779080306340,1.18584058888429;1.19999998299588,0.247699798635963,7966.02403815256,2.17244687084155,2.17399676459186,785.523923833669,163.763027859524,-151.204440335947,-27.9915788604901,1.16756876439721;1.19999998006275,0.247697284186725,8363.62161409924,2.04581642906841,2.17394406820435,781.348287649517,140.586090658485,-160.065398384711,-27.1654230538542,1.14569498554604;1.19999997647729,0.247699333969614,8768.26711810504,1.92102355012780,2.16958772847373,777.249297278866,118.026095213600,-167.129277553142,-26.2318503148388,1.12080266090041;1.19999997207686,0.247706154357580,9179.81030090171,1.79852403168886,2.16113654640997,773.229127466580,96.0926051875154,-172.488965440241,-25.2165709654444,1.09346261378540;1.19999996665263,0.247718825245822,9598.02994229498,1.67879369831393,2.14880772090945,769.289595076016,74.7954575994083,-176.236921939273,-24.1420176807849,1.06422392343282;1.19999995993285,0.247731316162190,10022.6686384132,1.56230416779027,2.13282724414120,765.432192296041,54.1446547482617,-178.467981464832,-23.0284540196698,1.03360420754334;1.19999995157144,0.247751616175942,10453.3171439475,1.44950201182840,2.11342945954527,761.658112123142,34.1502311902346,-179.281390216489,-21.8941958039053,1.00208105159410;1.19999994111043,0.247772947591593,10889.7083773395,1.34079096542365,2.09085592632290,757.968284136272,14.8221795586594,-178.782002818709,-20.7554748366518,0.970085220871165;1.19999992795480,0.247801797558804,11331.4142721524,1.23651486199582,2.06535371765232,754.363375502700,-3.82980114084806,-177.080949521431,-19.6264087717417,0.937996033856906;1.19999991130716,0.247833894527321,11778.1473987343,1.13694520758635,2.03717319656000,750.843824711640,-21.7963883619241,-174.295371696722,-18.5188156573697,0.906138694165021;1.19999989011483,0.247869068123603,12229.5186131206,1.04227119044461,2.00656544493490,747.409843653075,-39.0688807109342,-170.547692511350,-17.4422894393355,0.874783918405981;1.19999986293580,0.247908905889620,12685.1484293040,0.952595506582766,1.97377944028223,744.061443308861,-55.6393160014651,-165.964148011830,-16.4042154771723,0.844149392786061;1.19999982778294,0.247954079549359,13144.7095948371,0.867934766895818,1.93905918653645,740.798447635936,-71.5006409155182,-160.672926557460,-15.4099501843324,0.814403045723328;1.19999978194747,0.248002500097190,13607.9011018725,0.788224628043504,1.90264095626866,737.620504223705,-86.6468823365563,-154.802002767866,-14.4630537817322,0.785667594523974;1.19999972149426,0.248055472830743,14074.3802080054,0.713329516246098,1.86475080110901,734.527097403966,-101.073286163838,-148.476792054081,-13.5655362756987,0.758026008281940;1.19999964084352,0.248112217578208,14543.8563917646,0.643056156593521,1.82560247742367,731.517565612106,-114.776410797840,-141.817787554152,-12.7181075948733,0.731527527775555;1.19999953130591,0.248173275982734,15016.0297485893,0.577168904332141,1.78539590251545,728.591111556665,-127.754232115261,-134.938413167931,-11.9204614062240,0.706193811546820;1.19999938004701,0.248233230647806,15490.6284993443,0.515406125339101,1.74431618457721,725.746816208261,-140.006202828258,-127.943153683820,-11.1715121341191,0.682024840928663;1.19999916662740,0.248301819238912,15967.2406506042,0.457495955397459,1.70253324256312,722.983649882615,-151.533302361618,-120.926102955241,-10.4696191382784,0.659004343114260;1.19999885802808,0.248369494446681,16445.7652406506,0.403171035341205,1.66020197479948,720.300491571828,-162.338022849637,-113.969916970245,-9.81274620901613,0.637104573473982;1.19999839895246,0.248436849579505,16925.7972668612,0.352179285063088,1.61746292285790,717.696124090053,-172.424461426006,-107.145386839278,-9.19867895962693,0.616290246386810;1.19999769616417,0.248501528501568,17406.9853111195,0.304293857936047,1.57444327917288,715.169260633133,-181.798235983315,-100.511250977187,-8.62505485601209,0.596521715582352;1.19999665686754,0.248563000610606,17888.9290476386,0.259318958881531,1.53125819885083,712.718551488980,-190.466492773082,-94.1145375342859,-8.08949330747822,0.577757444278303;1.19999521990243,0.248674160115208,18371.2437866174,0.217092910130172,1.48801226469187,710.342594489471,-198.437886482094,-87.9912060487216,-7.58965099075192,0.559955725756050;1.19998957423824,0.248757819400981,18855.2759969730,0.177488423380532,1.44480100663677,708.039941592286,-205.722573322063,-82.1670574554010,-7.12326896425463,0.543075809994967;1.19997829713458,0.248838725698004,19339.4974294885,0.140409446707540,1.40171237880606,705.809086514427,-212.332293896976,-76.6589151516990,-6.68824387115116,0.527078443852128;1.19993831742522,0.248919871899110,19823.5077287082,0.105793150795366,1.35882807911471,703.648550510189,-218.279945366459,-71.4753040071538,-6.28238382430249,0.511926498977639;1.19913059553332,0.249000653946889,20307.0484837292,0.0736178781750029,1.31622489155185,701.557068024538,-223.578649910485,-66.6167168943720,-5.90315617195879,0.497586250800089;1.16911459474140,0.249096995849416,20789.8522389350,0.0443933837492771,1.27397625309704,699.540807522790,-228.205051682626,-62.0361868870955,-5.53042244543801,0.484065376205616;1.16299504798662,0.249187309593601,21272.3910461260,0.0376078862197705,1.23217043553922,697.883859527973,-230.724819230262,-56.1218253392945,-4.49293203617964,0.472807509969768;1.17034530639435,0.249282069268457,21753.8625143368,0.0361991037683149,1.19155530886236,696.338904893580,-232.466810450451,-50.7194868738382,-4.03999500075474,0.463509725250287;1.19988020567154,0.249304065271239,22234.1304057741,0.0293466346751847,1.15227319788916,694.777274732211,-234.123403795419,-46.5258827208973,-3.96765808053507,0.454585200417750;1.19993095190205,0.249367431892228,22710.0643413290,0.00409391402756274,1.11409369473988,693.005439286885,-236.679034364444,-44.3601790089231,-4.37371859400891,0.444559180788764;0.950293524578340,0.249510891215218,23183.9016287717,-0.0203933742431750,1.07635370219566,691.292209249192,-238.718673776214,-42.1759470878068,-4.18317723107743,0.434052006118864;1.19996505022093,0.249530428676945,23659.5283102167,0.0916654214347233,1.03906430159674,691.704010417572,-229.743417797091,-28.4654423511983,0.623044004179053,0.432787500437826;1.19995141230876,0.249604895210747,24128.7967854591,0.0747112308899090,1.00685273967123,690.103749395903,-231.227799500607,-29.6548459271473,-3.48887177637382,0.430436354640642;1.19992216650459,0.249668951434966,24595.9801966164,0.0455073792427472,0.975159928372670,688.557896124757,-232.356289076930,-30.1740884502901,-3.63115579187500,0.421649501873171;1.19986366670932,0.249747027844670,25060.3621393942,0.0194707373112005,0.943551741702252,687.064989909408,-233.042068362536,-30.0859788464722,-3.45675263707594,0.412604897230868;1.19988963893588,0.249811545607382,25522.3443312115,-0.00129297233940548,0.912132987552957,685.623686329719,-233.293842897927,-29.5548617600407,-3.26660219233423,0.404091937493602;1.19989956396956,0.249864598910699,25981.0081972130,-0.0170738586399489,0.881076504916616,684.231839386529,-233.138038969019,-28.7271680038703,-3.08861813196493,0.396195545311252;1.19990323325353,0.249901861152154,26435.7307140415,-0.0285243784106799,0.850539392555693,682.888077150274,-232.599477323328,-27.7110849311255,-2.92289684498108,0.388879613947249;1.19998357587954,0.249853281001669,26885.8159924481,-0.0362834046995357,0.820651224342836,681.590983196150,-231.703409230461,-26.5867164445311,-2.76864189000646,0.382090093220141;1.19987074311079,0.249818973553322,27327.4897815985,-0.0409228068084473,0.791515446955396,680.338649418093,-230.477222689516,-25.4142457506334,-2.62583254336346,0.375773082030815;0.999948841797802,0.249792454620104,27762.4901618318,-0.0428043126226568,0.763212546327425,679.130921712232,-228.938757498903,-24.2261208349600,-2.49009740347322,0.369886093349712;0.683940832835139,0.250098763867471,28192.1572202129,0.0281816471887721,0.735807973123122,679.131254364944,-221.209898905146,-16.7255774539743,-0.107056173522459,0.368316546559130;1.19997493022297,0.249924975586348,28632.6187237214,0.196198839415892,0.711748678041354,680.908743189176,-204.706998843632,-1.88506268831387,3.42532189261396,0.374749862270275;1.19997074029915,0.249718558601540,29054.3666797129,0.193517009456934,0.694219983528088,679.823845199547,-203.383916437457,-7.21251770592923,-1.97041730404254,0.378569599666304;1.19996684042794,0.249321509376175,29461.3497711549,0.173815946289146,0.677196082409669,678.777525297694,-201.977555568905,-10.7270881877072,-2.15855115684523,0.374062711515833;1.19996262947501,0.248587562107950,29846.7653918022,0.157186478973819,0.660081157781571,677.768608508613,-200.348051226694,-12.9268171916385,-2.06952288196809,0.368830707316466;1.19995832656842,0.247264146080363,30197.7296146236,0.146468991054548,0.642982738702108,676.796004799637,-198.494493193228,-14.1950498853873,-1.96772235930074,0.363857075596423;1.19995409967581,0.244910554646791,30491.4331467119,0.141159596090827,0.626101271282091,675.858750827160,-196.433221916963,-14.8162496475389,-1.87046460546951,0.359287295833481;1.19994800193401,0.258278145695364,30687.7221827812,0.140212247975139,0.609613254325588,674.956078942382,-194.182284899358,-14.9957620078562,-1.77863350115917,0.355103936494352;1.19993252717270,0.258278145695364,31632.6850924287,0.142688392916572,0.593653620109673,674.087541806934,-191.757713626473,-14.8781868652673,-1.69130826481290,0.351261526674170;0.553998765393602,0.258278145695364,32424.3073714974,0.147471563755533,0.578320802385107,673.245839339409,-189.209258336341,-14.6020246289715,-1.62069903225009,0.347700064849648;1.19983620020545,0.258278145695364,33103.6053380058,0.293797248466402,0.563671928271702,675.062652163036,-173.227743746255,-0.0894294253447310,3.27733364357387,0.350053043349403;1.19995956807675,0.258278145695364,33697.0182433911,0.302105351827379,0.554496189158321,674.275909721310,-171.037966932193,-4.29095882738547,-1.33395825034592,0.354175791621705;1.19987784621067,0.258278145695364,34229.4239283039,0.296214239632526,0.545914900689069,673.515709852781,-168.862339859709,-7.01098095787489,-1.46821669848838,0.351708324164700;1.19979623925382,0.258278145695364,34716.6500576936,0.291790139446165,0.537425078213147,672.782331415007,-166.586108203314,-8.69601723006712,-1.41365858231387,0.348595231835304;1.10423043335465,0.258278145695364,35169.8121202379,0.291141557075996,0.529073490295069,672.075115065653,-164.205786103839,-9.66998165503587,-1.35147385475516,0.345577912162973;0.644637777812536,0.258278145695364,35596.9589693057,0.310778404666445,0.520983804565621,671.719293668081,-160.081429296386,-8.41392346781078,-0.696463041754280,0.343406243467098;0.334725880077423,0.258278145695364,36003.6020119103,0.407761421524264,0.513836820969049,672.889071464338,-148.350260961962,0.621962609979734,2.10011458131528,0.344781391149667]; % output from fmincon using knitro guess
    otherwise % dice solution
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
end

% adjust guess for timestep
guess = interp1([1:guessed_timestep:guessed_horizon]',guess,[1:Params.timestep:Params.numyears]','linear','extrap');
clear guessed_timestep;

% store columns for guess
Params.col_abaterate = 1;
Params.col_savingsrate = 2;
if strcmp(Params.carbonmodel,'fair')
    Params.col_alpha = size(guess,2);
end

% vector of controls for obtaining feasible starting guess
if Params.optimizeonlysavings==1
    guess(:,Params.col_abaterate) = 0;
end
if Params.dicefirstperabate==1
    guess(1,Params.col_abaterate) = Params.fixabate1;
end
if Params.fixsavings>=0
    policyguess = guess(:,Params.col_abaterate);
else
    policyguess = [ guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
    if Params.dicelrsavings==1
        policyguess(end-round(5*10/Params.timestep)+1:end,:) = [];
    end
end
if strcmp(Params.carbonmodel,'fair')
    policyguess = [ guess(:,Params.col_alpha); policyguess ];
end
% ensure starting trajectory is feasible
[ C, ~, K, T, M, ~, Tocean, ~, ~] = trajectory( policyguess, 1, Params.horizon, Fun, Params );
if Params.fixsavings>=0
    guess(:,Params.col_savingsrate) = Params.fixsavings*ones(size(guess,1),1);
end
% store feasible guess
if strcmp(Params.carbonmodel,'fair')
    if Params.consumptionascontrol
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) C K T Tocean M guess(:,Params.col_alpha)];
    else
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) K T Tocean M guess(:,Params.col_alpha)];
    end
else
    if Params.consumptionascontrol
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) C K T Tocean M ];
    else
        guess = [ guess(:,Params.col_abaterate) guess(:,Params.col_savingsrate) K T Tocean M ];
    end
end

% store further columns for guess
if Params.consumptionascontrol
    Params.col_C = 3;
    Params.col_K = 4;
else
    Params.col_C = [];
    Params.col_K = 3;
end
Params.col_T = Params.col_K+1;
Params.col_Tocean = Params.col_T+1;
Params.col_M = [Params.col_Tocean+1:Params.col_Tocean+size(M,2)];
if strcmp(Params.carbonmodel,'fair')
   Params.col_alpha = size(guess,2);
end

clear C K T Tocean M;


%% Set up variable bounds

lb = zeros(size(guess,1),size(guess,2)); % all nonnegative
ub = Inf*ones(size(guess,1),size(guess,2));

% bounds on control variables
ub(:,Params.col_abaterate) = Params.bound_abate;
ub(:,Params.col_savingsrate) = 1; % savings rate cannot rise above 1

% fix abatement controls where appropriate
if Params.optimizeonlysavings==1
    lb(:,Params.col_abaterate) = 0;
    ub(:,Params.col_abaterate) = 0;
    disp('Constraining abatement to be zero');
end
if Params.dicefirstperabate==1
    lb(1,Params.col_abaterate) = Params.fixabate1;
    ub(1,Params.col_abaterate) = Params.fixabate1;
    disp(['Fixing first-period abatement at ' num2str(Params.fixabate1)]);
end

% bounds on state variables (for stability)
if Params.consumptionascontrol
    lb(:,Params.col_C) = 2; % consumption
end
lb(:,Params.col_K) = 1; % capital
lb(:,Params.col_T) = -1; % surface temperature
ub(:,Params.col_T) = 12; % surface temperature
lb(:,Params.col_Tocean) = -1; % ocean temperature
ub(:,Params.col_Tocean) = 20; % ocean temperature
switch Params.carbonmodel
    case 'dice'
        lb(:,Params.col_M) = bsxfun(@times,ones(Params.horizon,1),[0.5*588 100 1000 ]); % carbon sinks
    otherwise
        lb(:,Params.col_M(1)) = ones(Params.horizon,1)*0.5*588; % permanent sink
        lb(:,Params.col_M(2:end)) = bsxfun(@times,ones(Params.horizon,1),-7*Params.M0(2:end));
end
if strcmp(Params.carbonmodel,'fair')
    lb(:,Params.col_alpha) = 0.1;
    ub(:,Params.col_alpha) = 1000; % for stability - Millar et al. 2017 pg 7216 use 100 but Dietz et al use 1000
end


%% Adjust if solving by simulating trajectory conditional on policy

if Params.transitionsasconstraints~=1

    % initial guess vector: abatement rate, savings rate, and possibly alpha
    if Params.fixsavings>=0
        if ~strcmp(Params.carbonmodel,'fair')
            guess = guess(:,Params.col_abaterate);
            ub = ub(:,Params.col_abaterate);
            lb = lb(:,Params.col_abaterate);
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate) ];
        end
    else
        if ~strcmp(Params.carbonmodel,'fair')
            guess = [ guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        end
        if Params.dicelrsavings==1 % don't guess these fixed savings variables
            guess(end-round(5*10/Params.timestep)+1:end,:) = [];
            ub(end-round(5*10/Params.timestep)+1:end,:) = [];
            lb(end-round(5*10/Params.timestep)+1:end,:) = [];
        end
    end     
    
end


%% Scale variables around guessed path

if Params.scalevars
    Params.normalization = guess;
    Params.normalization(Params.normalization < 1e-5) = 1;
elseif Params.transitionsasconstraints
    Params.normalization = ones(size(guess));
else
    Params.normalization = 1;
end

guess = guess./Params.normalization;
ub = ub./Params.normalization;
lb = lb./Params.normalization;