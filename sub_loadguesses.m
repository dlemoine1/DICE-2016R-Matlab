% Initial guesses and bounds for DICE-2016R

% Last edited: September 16, 2020 by Derek Lemoine

% guess columns need to be ordered abatement rate, savings rate (if endogenous),
% and final column alpha (if using FAIR)
switch Params.carbonmodel
    case 'dice' % from dice climate module
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
    case 'joos' % from updated climate module
        guess = [0.138766025229609,0.261355650778958,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000;0.158232121541979,0.257774927155944,268.828540714191,1.25405498137236,0.0354688000000000,737.270309563312,99.5620136317820,38.6823878903873,14.2462912181536;0.178861598852014,0.254902080853013,319.767594268416,1.46041047635746,0.0769007301666603,748.109972844115,109.497577625119,47.8218212693349,18.2418726789481;0.200964816637435,0.252529028729608,376.314258426531,1.60934494478798,0.123940061537148,759.546932641082,119.925279420483,56.5685209373469,20.2519604459386;0.224669301034988,0.250538405760977,438.804819499663,1.74086001542456,0.174443827567676,771.496536625502,130.751735567444,64.8627062139489,21.5329521292936;0.250047735640455,0.248866040449451,507.482281894394,1.86604847162159,0.227701977954810,783.863053580480,141.873303603822,72.6378446519579,22.4640131769912;0.277159596003813,0.247468359224984,582.554140360052,1.98766250088227,0.283405758739481,796.541415941623,153.178005922107,79.8237801978931,23.1519510646340;0.306063215083351,0.246311761156828,664.217016651131,2.10606428343167,0.341350487972335,809.419183448169,164.547657635402,86.3497485995627,23.6208220415808;0.336819702492889,0.245367705910178,752.667333695670,2.22095458204246,0.401350757017952,822.378434279465,175.859893227239,92.1469128913929,23.8711858327349;0.369492561806846,0.244611604263574,848.104640410563,2.33187556369268,0.463217287068786,835.297463582024,186.989969446461,97.1503242680907,23.8984074526293;0.404147530090185,0.244021789324438,950.733081643521,2.43835526483681,0.526751668473998,848.052285517604,197.812343241315,101.300376813045,23.6981358468297;0.440850987635811,0.243579163121350,1060.76131386003,2.53994604599294,0.591746190750334,860.517936531254,208.202025158752,104.543817829189,23.2677659549315;0.479666779476185,0.243266547303468,1178.40213927376,2.63623130848755,0.657984985828583,872.569623776209,218.035756293171,106.834427712320,22.6066994509670;0.520655917790238,0.243068130516818,1303.87119983451,2.72682282988436,0.725245360798987,884.083781541215,227.193075762564,108.133493307062,21.7163093789564;0.563873327464842,0.242968645352291,1437.38468548856,2.81135501626079,0.793298994747890,894.939000263111,235.557243564439,108.410055132205,20.5997670741925;0.609362949091072,0.242952144896615,1579.15500368478,2.88947863034458,0.861912899479328,905.016912434589,243.016107519714,107.641066966493,19.2619331812355;0.657155326911083,0.243000223532880,1729.38256591527,2.96085500816073,0.930850134328747,914.203095123787,249.462976557877,105.811556611201,17.7093446647114;0.707289730067529,0.243088350537410,1888.24069906153,3.02515059672562,0.999870300039034,922.387950500801,254.797460469339,102.914737508625,15.9501827791924;0.760040062044353,0.243260018167180,2055.84433359731,3.07067483993115,1.06872983012638,929.466989666827,258.925684117929,98.9513306246545,13.9935043346887;0.815541400018391,0.243445348180264,2232.69316212182,3.10518985309622,1.13679596045974,935.335579939161,261.754791736946,93.9217778511016,11.8419612891817;0.873901372147837,0.243583665539123,2418.86412092860,3.13045924395660,1.20372135280938,939.892790550802,263.196898524466,87.8312755171460,9.50109074320877;0.935255145518280,0.243582445853032,2614.14052418563,3.14660498040351,1.26923044110839,943.041913043650,263.169565254639,80.6898425725041,6.97799453407991;0.999773192358015,0.243277968712922,2817.85518283352,3.15326255756613,1.33306117544442,944.690130357653,261.595389433683,72.5112737070209,4.27984350387357;0.999999918661969,0.243540092778766,3028.47238448467,3.14987706895579,1.39494802243656,944.748193785279,258.401609648767,63.3122365923094,1.41341933623568;0.999999952716746,0.243767709826696,3251.97143822708,3.14770231029619,1.45461561001821,944.794645527795,255.235583290716,55.2747044608768,0.501464247394265;0.999999963175748,0.243987339273607,3487.36200130518,3.14768003101845,1.51218055782766,944.835754711029,252.103427593422,48.2582632290396,0.209229196086027;0.999999967356903,0.244233630928788,3734.00648848403,3.14929735247069,1.56778753991615,944.872136212547,249.005355121312,42.1331101814551,0.111748321177564;0.999999967946070,0.244550306671658,3991.66677611387,3.15209769975791,1.62155887354300,944.904333839589,245.941502533375,36.7859525515880,0.0759169554839950;0.999999962244638,0.245005533179357,4260.52979887998,3.15578976998012,1.67359719363431,944.932828812679,242.911940272434,32.1179068553036,0.0599937627538522;1.13943690167674,0.244236030186500,4541.37645181468,3.16018203777023,1.72399174123007,944.958047085850,239.916680934648,28.0426653965834,0.0508434340266005;1.09656007399470,0.244701413044485,4818.96160871025,3.14013727561604,1.77282221131243,941.642383911357,233.514784924542,20.1469022081675,-4.19999827152522;1.09748281783550,0.244872672353350,5113.42972868793,3.12677096061854,1.81931092349876,939.373121328224,228.271177703414,14.6209275691465,-4.19999854357684;1.09853101849317,0.245025907222613,5418.57826945692,3.11568164355146,1.86376456476083,937.103858801837,223.092788723884,9.80174829825269,-4.19999855657656;1.09970664914551,0.245171641606228,5733.70306731418,3.10559606388611,1.90632974543971,934.834596288220,217.978806778562,5.59896225129925,-4.19999854440803;1.10101027439183,0.245314102257195,6058.36379357732,3.09609093781299,1.94710480026689,932.565333796511,212.928430804331,1.93373016589270,-4.19999851274273;1.10244213281793,0.245454895837588,6392.23345831685,3.08698069457214,1.98617032894346,930.296071334611,207.940869700143,-1.26270335019739,-4.19999846492951;1.10400256319914,0.245594582545488,6735.03464845746,3.07815225628161,2.02359788137483,928.026808909783,203.015342203735,-4.05029958747454,-4.19999840282674;1.10569217440058,0.245733217114559,7086.51098346851,3.06951982520644,2.05945273012166,925.757546528931,198.151076769548,-6.48135053678619,-4.19999832747193;1.10751191771178,0.245870942010196,7446.41208956283,3.06101193544460,2.09379501135454,923.488284198821,193.347311448098,-8.60145982457611,-4.19999823936571;1.10946309478152,0.246007690258190,7814.48996455611,3.05256722774168,2.12668038677361,921.219021926272,188.603293766819,-10.4503981824505,-4.19999813859976;1.11154737363638,0.246142845676091,8190.49260813516,3.04413263012950,2.15816053936652,918.949759718285,183.918280612330,-12.0628494986787,-4.19999802496934;1.11376681657492,0.246276982149269,8574.15380896029,3.03566224710017,2.18828359045246,916.680497582147,179.291538114134,-13.4690614466210,-4.19999789804536;1.11612379228586,0.246409577370294,8965.21169982773,3.02711649872822,2.21709446477848,914.411235525519,174.722341529745,-14.6954128950796,-4.19999775721998;1.11862104754423,0.246540041420038,9363.38866827337,3.01846138295653,2.24463521393278,912.141973556520,170.209975131251,-15.7649087444884,-4.19999760171964;1.12126169657773,0.246669124422714,9768.39101277417,3.00966782298996,2.27094530367958,909.872711683814,165.753732093277,-16.6976114714841,-4.19999743061053;1.12404912095477,0.246796050584402,10179.9338553706,3.00071108544007,2.29606186933614,907.603449916677,161.352914382329,-17.5110174771408,-4.19999724282116;1.12698707968792,0.246920336984652,10597.7108601092,2.99157026125347,2.32001994268367,905.334188265105,157.006832647558,-18.2203852986391,-4.19999703710022;1.13007967372850,0.247044117114011,11021.4022540218,2.98222780329492,2.34285265351504,903.064926739907,152.714806112861,-18.8390218413090,-4.19999681202355;1.13333115655149,0.247164384692924,11450.7283927581,2.97266911513963,2.36459140860756,900.795665352637,148.476162470161,-19.3785320006016,-4.19999656619690;1.13674633242191,0.247283214248495,11885.3374800434,2.96288218604801,2.38526605062965,898.526404115839,144.290237774339,-19.8490363559632,-4.19999629792635;1.14033013576442,0.247399909981283,12324.9251295232,2.95285726745359,2.40490499923387,896.257143043259,140.156376339437,-20.2593610207882,-4.19999600515112;1.14408787682163,0.247514248309594,12769.1655259635,2.94258658665339,2.42353537635334,893.987882149749,136.073930635831,-20.6172032101772,-4.19999568582295;1.14802519348156,0.247627434519570,13217.7259775895,2.93206409375604,2.44118311750355,891.718621451515,132.042261189045,-20.9292756314297,-4.19999533757802;1.15214793827063,0.247738260343918,13670.3020796143,2.92128523828088,2.45787307069613,889.449360965978,128.060736479421,-21.2014324068934,-4.19999495812963;1.15646239578374,0.247849412591016,14126.5548317604,2.91024677215194,2.47362908439401,887.180100712314,124.128732843730,-21.4387788898767,-4.19999454453239;1.16097493949982,0.247960919289046,14586.2152004505,2.89894657611690,2.48847408577778,884.910840710062,120.245634376032,-21.6457674371499,-4.19999409540148;1.16569230518853,0.248073655728726,15049.0045921151,2.88738350700396,2.50243015044931,882.641580982959,116.410832835133,-21.8262809249577,-4.19999360496912;1.17062150920454,0.248191334117535,15514.6610972086,2.87555726333421,2.51551856457217,880.372321555749,112.623727545978,-21.9837055921017,-4.19999307014504;1.17576960051984,0.248321727448283,15983.0165606104,2.86346826725493,2.52775988033008,878.103062454840,108.883725306214,-22.1209945611028,-4.19999248784959;1.18114333145186,0.248473546443176,16454.0978843056,2.85111756089318,2.53917396548552,875.833803710841,105.190240295867,-22.2407232322841,-4.19999185177429;1.18674916014836,0.248666127598083,16928.1252854271,2.83850671536845,2.54978004772938,873.564545355265,101.542693982122,-22.3451376003119,-4.19999115879823;1.19259227319154,0.248930377296159,17405.8034131861,2.82563775107282,2.55959675442911,871.295287423333,97.9405150315778,-22.4361963829077,-4.19999040322604;1.19867583870003,0.249324142319582,17888.6015228618,2.81251306781159,2.56864214831500,869.026029953376,94.3831392200866,-22.5156077655583,-4.19998957932531;1.19999937713554,0.249349110953974,18379.4825355285,2.79913535901482,2.57693375957788,866.756770431773,90.8700067104917,-22.5848647661515,-4.19999193014158;1.19999930099904,0.249390306634634,18864.8339522763,2.78604458709285,2.58448861395874,864.542848820953,87.4576134765373,-22.5733471418819,-4.12962973566813;1.19999921479204,0.249439708466813,19346.4843742901,2.77341687226427,2.59134151704530,862.398136727114,84.1590058664964,-22.4733589626870,-4.01960549890178;1.19999911721745,0.249493690430518,19825.4210334000,2.76122338395031,2.59753207912274,860.321251224441,80.9713430884178,-22.2980132137680,-3.89892545381338;1.19999900656730,0.249549968955257,20302.1827387386,2.74942193123438,2.60309758348688,858.310727216988,77.8917349794658,-22.0588524617492,-3.77677303113560;1.19999888109768,0.249606751342147,20777.0240950669,2.73798085221273,2.60807261131030,856.365047334706,74.9172734377853,-21.7660108653408,-3.65608911163912;1.19999873867054,0.249663082411493,21250.0063640282,2.72687665433702,2.61248949150098,854.482661760585,72.0450530840982,-21.4283685495270,-3.53783544766875;1.19999857672283,0.249719441450964,21721.0781303122,2.71609052699803,2.61637865503740,852.662002218343,69.2721856468084,-21.0536938235338,-3.42233653890066;1.19999839242456,0.249774546628596,22190.1595732185,2.70560641513736,2.61976885868407,850.901491649442,66.5958097246071,-20.6487728106078,-3.30970512048676;1.19999818249982,0.249828374697401,22657.0866481096,2.69541009893643,2.62268733560348,849.199550464865,64.0130968968126,-20.2195269489898,-3.19997969606245;1.19999794267449,0.249880821449989,23121.6822262201,2.68548876231595,2.62515990955680,847.554603245141,61.5212582197709,-19.7711148814936,-3.09316701562921;1.19999766730432,0.249932313345300,23583.7588904768,2.67583074493069,2.62721109055061,845.965082965731,59.1175480915231,-19.3080245289823,-2.98925851766286;1.19999735175292,0.249979047358349,24043.1454451943,2.66642537675359,2.62886415879953,844.429434674026,56.7992675031050,-18.8341540999415,-2.88823617277977;1.19999698907131,0.250026299391333,24499.5117696520,2.65726284729593,2.63014124020997,842.946118220288,54.5637662741857,-18.3528839680663,-2.79007551572405;1.19999657248486,0.250071073813360,24952.7856455184,2.64833412993825,2.63106337485089,841.513613816901,52.4084481764137,-17.8671356807750,-2.69474299814530;1.19999609212377,0.250112891317637,25402.7452337140,2.63963084511773,2.63165058052386,840.130419591135,50.3307677396840,-17.3794338254110,-2.60220534038682;1.19999553597985,0.250148500207339,25849.1640760821,2.63114520732725,2.63192190952005,838.795056474391,48.3282346608246,-16.8919504480975,-2.51242313014170;1.19999489102716,0.250174658995687,26291.6913073582,2.62286996096777,2.63189550164550,837.506069973214,46.3984149430676,-16.4065478436539,-2.42535278371749;1.19999413797556,0.250190681965171,26729.8805080965,2.61479833881353,2.63158863326246,836.262033379076,44.5389335044756,-15.9248140026992,-2.34094533049753;1.19999325642446,0.250185631615323,27163.3265226029,2.60692402063598,2.63101776325119,835.061549957007,42.7474757012962,-15.4480948519909,-2.25914733087935;1.19999222930264,0.250139574163255,27591.1814221525,2.59924107555539,2.63019857600228,833.903252875975,41.0217865044826,-14.9775253058864,-2.17990403499425;1.19999101643104,0.250029656040529,28011.8309555699,2.59174397220024,2.62914602098708,832.785811028033,39.3596757568004,-14.5140486932257,-2.10315288372707;1.19998953325942,0.249816380894287,28422.9220843931,2.58442762668297,2.62787435132833,831.707937277048,37.7590258690277,-14.0584305419997,-2.02881838530342;1.19998776293853,0.249407272627455,28820.7143745593,2.57728743100281,2.62639716269039,830.668394351248,36.2177969916181,-13.6112736629435,-1.95681350756257;1.19998562687133,0.248673692919031,29197.7896228764,2.57031932841925,2.62472743181301,829.666005199094,34.7340367229732,-13.1730255034136,-1.88703443856878;1.19998303741582,0.247357705678103,29542.0812035350,2.56352011118909,2.62287755629762,828.699683742716,33.3059107234469,-12.7439580522886,-1.81933301089615;1.19997977627248,0.245033629274380,29831.4289889777,2.55688774374477,2.62085940316393,827.768466635835,31.9317339840513,-12.3241490096888,-1.75350679319915;1.19997557650639,0.258278145695364,30027.4121344311,2.55042211379630,2.61868436674368,826.871586301071,30.6100442583874,-11.9134117190838,-1.68924350157650;1.19997031518853,0.258278145695364,30949.4242759583,2.54412618025107,2.61636345014347,826.008579507094,29.3397112169134,-11.5111878742785,-1.62605841089978;1.19996326227523,0.258278145695364,31723.1375553876,2.53793042398059,2.61390738296713,825.172215002155,28.1126418902841,-11.1257862021853,-1.57240543517855;1.19995339721622,0.258278145695364,32387.7456304703,2.53184313909497,2.61132416636158,824.362992220589,26.9288130126628,-10.7544060186954,-1.52110097335215;1.19993900621875,0.258278145695364,32971.9651598968,2.52587653067617,2.60862181143452,823.580934512486,25.7877108442600,-10.3952235712596,-1.47050190632799;1.19991622735907,0.258278145695364,33496.6967012205,2.52003746474706,2.60580847188874,822.825756899555,24.6885101999487,-10.0470490721116,-1.42048598175117;1.19987627399287,0.258278145695364,33977.0832969545,2.51432874672666,2.60289225764592,822.096983999889,23.6301998836510,-9.70909235816172,-1.37125703550773;1.19978607012923,0.258278145695364,34424.0620879150,2.50875102745655,2.59988109827466,821.394040062866,22.6116778128192,-9.38079476924714,-1.32300648845307;1.19944986447605,0.258278145695364,34845.5152228470,2.50330473395784,2.59678267586685,820.716377438047,21.6318845788244,-9.06163258157869,-1.27575852553043;0.00155866578003304,0.258278145695364,35247.1146861352,2.49799628657043,2.59360442584194,820.064026926239,20.6903702361999,-8.75039731079572,-1.22878520775116];
    case 'fair' % from updated climate module
        guess = [0.268875130522752,0.258752247046194,223,0.850000000000000,0.00680000000000000,727.100000000000,90.2000000000000,29.2000000000000,4.20000000000000,0.380703525630485;0.307107690160891,0.255496620588073,267.190376398600,1.38829100897326,0.0354688000000000,735.850391401464,131.597614222955,68.1280005663448,17.5673839612113,0.424305462368162;0.346718893830605,0.252870444941694,316.542009787210,1.72712449073936,0.0814647551050910,744.878371672121,173.559312518594,99.4634099732056,20.7437015529966,0.448781252846158;0.388832057219470,0.250770098693997,371.386130244116,1.98847650405112,0.137417186116656,754.074721302995,215.451732449875,124.794484603809,22.4478019266713,0.466391602104505;0.434178021970290,0.249111484347229,432.012139309239,2.21055712409694,0.200353202926428,763.306022227139,256.601748168900,145.007289528822,23.4694469782567,0.482935082417268;0.483261551293849,0.247846405417180,498.668882288059,2.40631915651638,0.268700136246225,772.418221553060,296.295323439480,160.744217219446,24.0273846010694,0.500349168273968;0.536389836039013,0.246939434242320,571.604236812719,2.58045629203249,0.341379182935411,781.239927521585,333.765647375568,172.387228319455,24.1430910007762,0.519427343460353;0.594207852020425,0.246348093394155,651.084333363222,2.73456243833792,0.417507804644711,789.586762700432,368.203323806891,180.095698550049,23.7713166478283,0.540647628019436;0.657070553076022,0.246015874794344,737.378241485662,2.86864267638529,0.496287662190281,797.257002824988,398.727861912452,183.809740405012,22.8199094731312,0.564468896942914;0.725354129806774,0.245851505672223,830.733118742203,2.98175975529420,0.576947732672911,804.037512314939,424.414688805280,183.319212423663,21.1850775751827,0.591364499602720;0.799354438256442,0.245690656577722,931.299244739796,3.07218389163753,0.658711341442035,809.704753496324,444.295712895207,178.281472011320,18.7397352908112,0.621860622527835;0.879306996342654,0.245238302301047,1038.96170882084,3.13738438869718,0.740769408148681,814.027746477949,457.369510231890,168.241858711809,15.3339178614612,0.656521145784485;0.964631347315306,0.243978655870379,1153.00548456335,3.17387898062570,0.822254317487330,816.771016707881,462.610389296616,152.643509384823,10.7897319036748,0.695911208297490;0.999999161566721,0.243419699234373,1271.51742877251,3.17728298874841,0.902209556034035,817.714621813022,459.063956825431,130.932118967777,4.94920226264427,0.740380346004042;0.999999635865434,0.243539798673761,1398.66086576367,3.16821905351525,0.979562052746324,817.872238346501,452.062080160481,109.748897050359,1.53625738789399,0.780101425318653;0.999999742748884,0.243568489166103,1537.61338288660,3.16458756828201,1.05397639077247,818.011720773497,445.475216906089,92.9037690082186,0.807676448007640,0.812566361520701;0.999999794036955,0.243541862173528,1687.40583006164,3.16688497523510,1.12573717080779,818.135161358346,439.198080386301,79.2274579766699,0.610863680371686,0.842118876643470;0.999999806711633,0.243487795545058,1847.36047930166,3.17381251487613,1.19513619615832,818.244405851923,433.183065769580,67.9872941426590,0.530494984541557,0.869817670973888;0.999999812796777,0.243486624421055,2017.03987367057,3.17292808813747,1.26241119099473,818.341087547338,427.398906030816,58.6609754548427,0.478703073368421,0.892310231402350;0.999999815825426,0.243508173787224,2196.60931436097,3.17150750944071,1.32736876549758,818.426651279862,421.796828413414,50.8272591541869,0.434387734223247,0.912475923410515;0.999999814508614,0.243549114703862,2386.01948890758,3.17114490909229,1.39006948279165,818.502375665917,416.354443997224,44.1981561499453,0.393885353334280,0.931217635182845;0.999999807000405,0.243607894281063,2585.21756472646,3.17200684314458,1.45062604728587,818.569392322107,411.057792994489,38.5564051173140,0.356566521106196,0.948882958299678;0.999999806562746,0.243680049793156,2794.17021045261,3.17393508464925,1.50915299434506,818.628702787497,405.896443421059,33.7316903862169,0.322270230472557,0.965650985389247;0.999999808887863,0.243764598725455,3012.84317482039,3.17672559793184,1.56575558541541,818.681193116737,400.861917799758,29.5880309028343,0.290867675924643,0.981640199431927;0.999999803780608,0.243868991661349,3241.21418424652,3.18019345488253,1.62052856584096,818.727647551963,395.947050012460,26.0155989420722,0.262208604865470,0.996940641511482;0.999999794670910,0.243984447292149,3479.31953292649,3.18418338472480,1.67355717206838,818.768760389383,391.145640978142,22.9248977787048,0.236125180517183,1.01162502377683;0.999999777586239,0.244102694049066,3727.13696097060,3.18856751228259,1.72491846329870,818.805146016707,386.452235418288,20.2424442801280,0.212439724904345,1.02575362434172;0.999999722788389,0.244259660680266,3984.58611004924,3.19324088052757,1.77468253096415,818.837348273062,381.861966651704,17.9075023230864,0.190973388173220,1.03937707848379;0.999999568565882,0.244462699026564,4251.86846697402,3.19811725944615,1.82291351484930,818.865849195554,377.370444811286,15.8695754349940,0.171553180892752,1.05253828585167;1.04685400415541,0.244254737598177,4529.22106367458,3.20312568128704,1.86967044216560,818.891076959582,372.973674101859,14.0864587062649,0.154016403634156,1.06527384077912;1.03057568178102,0.244551409145539,4811.58861945231,3.17867304559120,1.91500792029573,817.792657628258,362.925729827122,5.68896519780264,-4.19997002596451,1.08901413079281;1.03047639217281,0.244723192832293,5107.13745809040,3.16214847289695,1.95797253455577,817.087926810840,355.106699902876,0.713512599105762,-4.19999554082946,1.10080107559262;1.03043003674262,0.244872303177172,5413.01617215507,3.14830345953273,1.99891451645937,816.390758247446,347.460684614897,-3.62957585766978,-4.19994035576877,1.11236490633956;1.03044571468804,0.245001442788372,5728.55850885511,3.13563517162884,2.03799374052387,815.700834955581,339.980489487687,-7.42698116659486,-4.19993031668689,1.12326163738140;1.03052339159013,0.245166910908695,6053.26705570511,3.12365195132862,2.07531354918144,815.017606764012,332.656558673098,-10.7537112277934,-4.19991819449066,1.13342461568793;1.03065971853262,0.245308466991036,6387.35196150756,3.11214460450790,2.11095705485444,814.340507447581,325.479551403161,-13.6736037034931,-4.19990343414430,1.14288114070704;1.03085246879208,0.245465879088009,6730.25227587648,3.10099085650109,2.14499743154266,813.669013914776,318.440927500038,-16.2408855801629,-4.19988511004882,1.15167760718845;1.03109897670172,0.245612069611495,7081.96239336018,3.09010148919056,2.17750120799124,813.002653369685,311.532980969540,-18.5017458380150,-4.19986190096569,1.15986048488917;1.03139755276575,0.245765713697052,7442.08606352890,3.07940444473576,2.20852961755202,812.340999454961,304.748758423622,-20.4956669308906,-4.19983169998980,1.16747201714090;1.03174652669660,0.245890538011027,7810.50807557467,3.06883930404913,2.23813936167627,811.683666707380,298.081964779896,-22.2565160481687,-4.19979084136404,1.17454971689341;1.03214520154796,0.246014836326884,8186.56291489480,3.05835475189329,2.26638315971695,811.030305419038,291.526878637479,-23.8134367717931,-4.19973360604812,1.18112676776768;1.03259239960577,0.246206789431574,8570.06859037639,3.04790704600389,2.29331019385094,810.380598165568,285.078285037723,-25.1915750847375,-4.19964836411072,1.18723256853545;1.03308557461252,0.246310130786680,8961.89752306684,3.03745896829788,2.31896648682414,809.734259425997,278.731431812227,-26.4126634315750,-4.19950651004583,1.19289322886618;1.03362452973851,0.246464994674620,9360.16171887325,3.02697918965904,2.34339523119425,809.091041632525,272.482025157057,-27.4954682794509,-4.19923449880776,1.19813196019320;1.03326389517762,0.246568222876177,9765.64040367548,3.01644208595882,2.36663708578205,808.450750589003,266.326277957146,-28.4561056178762,-4.19866667328213,1.20296936528983;1.02800274633229,0.246817689390569,10177.0934066205,3.00637134104330,2.38873045578806,807.830902287543,260.351409756585,-29.1999558637174,-4.12560450724578,1.20725158215173;1.02858546732169,0.246863204112623,10597.1257810189,2.99959111206830,2.40973024588674,807.321130912023,255.013256370787,-29.1988412099206,-3.65739574550050,1.21025752805281;1.02918329003154,0.247007827858022,11020.7425593469,2.99295486818567,2.42978551533691,806.812483850145,249.743288657553,-29.1987197472934,-3.47937381032384,1.21378106832074;1.02981528654058,0.247101304048967,11450.1491790426,2.98596084735722,2.44893327333377,806.305305630154,244.543352938095,-29.1986590971201,-3.41135243793805,1.21725084235224;1.03048662216600,0.247229797400896,11883.9915276224,2.97860448269316,2.46719221085057,805.799565748154,239.412095334907,-29.1986503823197,-3.38530659276010,1.22053219326412;1.03119845448734,0.247350659054680,12322.9402737408,2.97093625420948,2.48458022809321,805.295173808610,234.347616613843,-29.1987146431768,-3.37534172797004,1.22359728013878;1.03195199185253,0.247493761821582,12766.5213813256,2.96299159322579,2.50111633298117,804.792026231359,229.347954047198,-29.1988895410723,-3.37157916144396,1.22644344278653;1.03274743959384,0.247589756288102,13214.9700812868,2.95479062333898,2.51682009182949,804.290022712589,224.411218249653,-29.1991905297159,-3.37022208608467,1.22907339172955;1.03358555369051,0.247699704151816,13666.7753102904,2.94634525567678,2.53171108990081,803.789074826016,219.535644996588,-29.1995731976120,-3.36977273144535,1.23149070262968;1.03446624428890,0.247762430491447,14122.1418558488,2.93766408760773,2.54580865153719,803.289117628974,214.719652586129,-29.1998695347458,-3.36956797715011,1.23369887744767;1.03539338716066,0.247897027767543,14579.6215667372,2.92875443045892,2.55913173636359,802.790102300470,209.961799670675,-29.1998451409282,-3.36929475720355,1.23570139995198;1.03636770930920,0.247987920522195,15041.0638001779,2.91962197226300,2.57169890796283,802.291956968754,205.260580686987,-29.1994462169740,-3.36893561906166,1.23750209111673;1.03739458082389,0.248029655650123,15504.7972730300,2.91027150799673,2.58352829214904,801.794600816494,200.614497318541,-29.1986939604203,-3.36853021038130,1.23910469297998;1.03848008893707,0.248338635770317,15969.2798661618,2.90070637833980,2.59463756148786,801.297918987202,196.021927605635,-29.1978302636636,-3.36824360761700,1.24051312366297;1.03961248989645,0.248362497830833,16442.1365909768,2.89092831083426,2.60504390126082,800.801757483066,191.481099449911,-29.1973259544320,-3.36831136666939,1.24173132323140;1.04078869022497,0.248212801027529,16913.3856917997,2.88094239758109,2.61476397118632,800.306069961424,186.990843148549,-29.1969533980024,-3.36839066869025,1.24276182296687;1.04201484472041,0.248617662363132,17378.4023254866,2.87075901703926,2.62381403768374,799.810956317086,182.550779323400,-29.1956180584245,-3.36774910288876,1.24360652287587;1.04328868086978,0.248503852402364,17855.6136041398,2.86038805215392,2.63221016698183,799.316491776567,178.160432243332,-29.1924982375201,-3.36620488378215,1.24426886345613;1.04463918813665,0.248750085359547,18325.9093419577,2.84983489545919,2.63996821507768,798.822635460650,173.818762982068,-29.1875823917189,-3.36417254952345,1.24475351249184;1.04605993051642,0.248774077912905,18802.4231677897,2.83909911888232,2.64710368221065,798.329200502324,169.524022304302,-29.1817711821985,-3.36242700352026,1.24506558449158;1.04755538257412,0.248878830252549,19276.2555205419,2.82817970072836,2.65363152705749,797.836001955783,165.274515535325,-29.1758731867075,-3.36127466465180,1.24520878468475;1.04912393405248,0.248989743681545,19750.5936000073,2.81707778913426,2.65956616496230,797.342912405130,161.068883897189,-29.1702686414023,-3.36060532020063,1.24518588554450;1.05076431228306,0.249052344151344,20225.2874690345,2.80579577674100,2.66492156018415,796.849829234719,156.905930940739,-29.1651528636768,-3.36027814288597,1.24499969230816;1.05248339973544,0.249296494078070,20698.2611636558,2.79433766790633,2.66971128354708,796.356693681195,152.784717718403,-29.1604380109282,-3.36006113787736,1.24465282837152;1.05427916870622,0.248859940327347,21176.0998555804,2.78270669738147,2.67394858061529,795.863423883323,148.704215761430,-29.1561937480093,-3.35996260775049,1.24414844752097;1.05614902953276,0.249050045840780,21632.2715849794,2.77090589338714,2.67764635658534,795.369940277383,144.663438057836,-29.1524755315047,-3.35998102533706,1.24348955052990;1.05812936008545,0.249231575458857,22095.0109582714,2.75894639884512,2.68081718083660,794.876396314257,140.662620743733,-29.1479058434755,-3.35915730913873,1.24267718881551;1.06014418370242,0.249316249101527,22561.7473754145,2.74682280516319,2.68347357424889,794.382459473688,136.699520795337,-29.1442424868126,-3.35912366722940,1.24171813751426;1.06225787903167,0.249205523862030,23027.1184347084,2.73455225054505,2.68562744809998,793.888492001964,132.775501811473,-29.1388005113632,-3.35766167835178,1.24061027227315;1.06452920052589,0.249023802723892,23483.0826671707,2.72213713609406,2.68729089138311,793.394365269240,128.889406756969,-29.1321889480436,-3.35592434077720,1.23935991295965;1.06673646240857,0.249410712354415,23928.4001609564,2.70956415849109,2.68847566370328,792.899586164944,125.038240558659,-29.1272094696570,-3.35587765735688,1.23797358116146;1.06920731996450,0.250746871292817,24388.2957129095,2.69688115952667,2.68919267252607,792.405386947606,121.227904497248,-29.1157710588015,-3.35118267471669,1.23644087565716;1.07155114276062,0.249572770749162,24898.0319002192,2.68404866980306,2.68945408108409,791.910403552327,117.450926817183,-29.1065742091988,-3.35005158221061,1.23478387737621;1.07441888321616,0.249669834286264,25337.6368846988,2.67111205865181,2.68927029710053,791.415916158228,113.713503985828,-29.0911955710157,-3.34482904255387,1.23298764253910;1.07694926202972,0.249980157001265,25779.1545705902,2.65799011187987,2.68865291699328,790.919442932338,110.002474089392,-29.0851954630750,-3.34799949153053,1.23108151182505;1.08014639304837,0.250111745343368,26230.5216383402,2.64478635007055,2.68761038161942,790.423932961931,106.332695475277,-29.0691679075661,-3.34210926483448,1.22902935788134;1.08257118503512,0.250207443310625,26680.2984176291,2.63138494221325,2.68615436454676,789.925769584594,102.685183556002,-29.0660337061066,-3.34732370664753,1.22687878274940;1.08625163535947,0.249928374865270,27126.3599129069,2.61797947724117,2.68429220418742,789.430427191665,99.0878157141669,-29.0405124915957,-3.33417099583537,1.22456986694779;1.08885927499899,0.249900110283223,27551.4006223611,2.60434348724995,2.68203757147125,788.931108880017,95.5052179283882,-29.0363479085050,-3.34155397411393,1.22219023924622;1.09261527228671,0.250295631688062,27971.5278743393,2.59071517986485,2.67939597260772,788.434846014726,91.9733671851437,-29.0078595410603,-3.32789046180601,1.21965005400889;1.09793090639320,0.249363863227015,28406.9781334059,2.57691411376226,2.67638082565447,787.935915776859,88.4624073825158,-28.9923837150032,-3.32930047595613,1.21703523392500;1.10052407806993,0.248590732075681,28788.7683093376,2.56263835479135,2.67299895745013,787.426970086226,84.9345340092488,-29.0334867162477,-3.36647933070156,1.21436473041104;1.11030994555634,0.246194738614230,29137.3668600871,2.54845100184574,2.66924669695973,786.923296143747,81.4684142076555,-29.0310188231152,-3.35465612807569,1.21147188815311;1.10461624010075,0.251251222608867,29379.6142878446,2.53311907959893,2.66513964332586,786.390623034040,77.8876878055343,-29.1995902581929,-3.46375668892143,1.20868551320014;0.709483262690603,0.248124271010997,29914.4795496911,2.51940985237273,2.66065094415914,785.904292719937,74.5800807257038,-29.0582281459118,-3.31131488214748,1.20527574316990;0.190192570615238,0.258278145695364,30249.7338370993,2.57391952087717,2.65584874703840,787.208341256703,80.4843495351524,-17.9263023302191,4.05770687065385,1.19020211422367;0.998262181944403,0.258278145695364,31106.8152914650,2.71131048555463,2.65306315334892,790.710922605770,97.5870171873511,5.52128854184928,15.7468037286184,1.17196274876643;0.652098397400201,0.258278145695364,31808.4291028667,2.72457315842489,2.65504356264392,790.718213558509,96.5725984219717,4.95686980347483,5.87323422148868,1.19966315278016;1.07939901785421,0.258278145695364,32417.4082904063,2.76721811334713,2.65740756890047,792.127284019234,102.779918478256,13.0745093946598,7.96840661410016,1.19578441430717;1.11546836367699,0.258278145695364,32952.0170850491,2.75304830448624,2.66114112741166,791.816658700506,100.101563636390,9.75210840838526,1.75282127762890,1.21137640982263;0.0468683911076864,0.258278145695364,33442.1605705660,2.72773241748768,2.66426597143219,791.380612609222,96.8218733395149,6.03023019371123,-1.11095780213970,1.21677428587212;1.10012465291482,0.258278145695364,33901.3699543470,2.83986425293176,2.66642383059808,794.853492880715,113.623264379441,26.7305808647123,13.7967145636833,1.18692228293967;1.12041102469226,0.258278145695364,34309.9094855932,2.83374097820316,2.67232080495742,794.501603646578,110.609956772821,21.6570974711511,3.75770019253280,1.21716076601360;1.14408929938941,0.258278145695364,34703.3904632145,2.80741322871182,2.67780909084778,794.093585492455,107.369780149763,16.8441137131995,-0.224572341366790,1.22664233382216;0.679724350062467,0.258278145695364,35088.5702609421,2.77917930333800,2.68221563153516,793.622884358297,103.850310356699,12.1701317044540,-2.02127719525419,1.23082714144435];
    otherwise % dice solution
        guess = [0.164544457558551,0.260405842950710,223,0.850000000000000,0.00680000000000000,851,460,1740;0.186974763477815,0.257200362731100,268.296828217147,1.01226400843172,0.0278800000000000,884.548431211645,471.289302325581,1740.67069767442;0.211271263932616,0.254468402580559,319.159268635012,1.17728481927510,0.0524896002107929,919.035898150249,484.313670674548,1741.41943781504;0.237488498694681,0.252154154823901,375.790487831115,1.34443062865725,0.0806094806874006,954.314238826053,498.833685272675,1742.25825154273;0.265683044405300,0.250208537348144,438.385800016000,1.51302378432577,0.112205009386647,990.137106759193,514.640766748127,1743.19747641296;0.295914484168474,0.248587681038549,507.134813719445,1.68233003401830,0.147225478760125,1026.19002636728,531.539130909686,1744.24597477987;0.328244734808366,0.247253566106529,582.222190780878,1.85156347954012,0.185603092641579,1062.11250107867,549.335013671445,1745.41122552388;0.362736730406764,0.246173244829845,663.829365225871,2.01989912921453,0.227252102314043,1097.51442738521,567.830736425768,1746.69934021940;0.399460309430358,0.245317629770874,752.136098562305,2.18648802027208,0.272068277986555,1131.98847658561,586.821945855557,1748.11503773638;0.438474909294678,0.244661101484639,847.321037310864,2.35047164137540,0.319928771543693,1165.11892350714,606.096899836627,1749.66159955790;0.479849801070561,0.244181241619720,949.562481790907,2.51099474062641,0.370692343289486,1196.48974226089,625.436957683023,1751.34082016438;0.523650060179990,0.243857768852301,1059.03935606598,2.66721480521471,0.424199903222909,1225.68918381329,644.617942290498,1753.15296092234;0.569945028490526,0.243671199315168,1175.93095464118,2.81830866656747,0.480275275772704,1252.31443391373,663.411775005869,1755.09671357562;0.618803144503064,0.243602167157055,1300.41393793071,2.96347589237441,0.538726110542574,1275.97447334592,681.588337515726,1757.16917523426;0.670283545177721,0.243628170265236,1432.65762628630,3.10193944130396,0.599344855088369,1296.29272250813,698.917298965259,1759.36583643316;0.724450325223910,0.243721088459544,1572.80957022324,3.23294419401779,0.661909719743759,1312.91001037420,715.169889504085,1761.68058199812;0.781381055046241,0.243840124439633,1720.97086356626,3.35575290695247,0.726185581600610,1325.48554662569,730.120670078865,1764.10570432544;0.841182395270314,0.243919259493642,1877.14293380458,3.46963951072521,0.791924764734407,1333.69671325889,743.549059633345,1766.63192903059;0.903931631110230,0.243868187319062,2041.11853779547,3.57092345962218,0.858867633384177,1337.23707358865,755.240527317189,1769.24845124967;0.969793882632936,0.243499989983253,2212.41615168178,3.65925046815423,0.926669029040127,1335.82116093771,764.987303810082,1771.94298023325;1,0.243348060166719,2389.76563654950,3.73419292279604,0.994983565017980,1329.17657585571,772.589522955083,1774.70178885400;1,0.243504159531988,2575.84014296289,3.79700530163856,1.06346379896243,1321.41131862247,777.855183379231,1777.50977103334;1,0.243653196187858,2773.25418086662,3.85000856333509,1.13180233652933,1315.57449738278,781.124197889690,1780.35049881525;1,0.243819039539117,2981.52476909142,3.89498186953554,1.19975749219948,1311.04743561484,783.033345902280,1783.20994770221;1,0.244027137997311,3200.42139058232,3.93330815249850,1.26713810163288,1307.41003772938,784.015878881274,1786.07857120015;1,0.244319403252527,3429.94411845351,3.96607769029698,1.33379235290452,1304.37712181604,784.366672786264,1788.94986956196;1,0.244759213357289,3670.41428210764,3.99416201625890,1.39959948633933,1301.75515613703,784.286512404912,1791.81941669512;1,0.245469281237480,3922.61625741725,4.01826695918728,1.46446354958732,1299.41286148139,783.912192919712,1794.68419848541;1,0.246662295411862,4188.24494317630,4.03897101507732,1.52830863482732,1297.26123628564,783.336982169767,1797.54216280085;1.20000000000000,0.245641426732340,4470.63180499187,4.05675338978155,1.59107519433357,1295.23998504387,782.624531428615,1800.39191339101;1.20000000000000,0.245813423529338,4743.67617564420,4.06288667200718,1.65271714921977,1271.37869521113,781.818333254884,1803.23250160999;1.20000000000000,0.245976281798493,5028.68084303990,4.05990876348112,1.71297138728945,1250.42505420948,778.316600322534,1806.06328464972;1.20000000000000,0.246130424495435,5325.14304940700,4.04971501461661,1.77164482169425,1231.52218509219,773.015429681568,1808.86540813261;1.20000000000000,0.246278803166712,5632.61292079809,4.03373803914666,1.82859657651731,1214.09093809361,766.526157823373,1811.62631798428;1.20000000000000,0.246421636946139,5950.70863442993,4.01307578575695,1.88372511308304,1197.74050257142,759.266503566531,1814.33775787897;1.20000000000000,0.246560112796836,6279.07431192442,3.98858251833091,1.93695887989989,1182.20765618601,751.522479435895,1816.99440761914;1.20000000000000,0.246694337470072,6617.38433705603,3.96093347835659,1.98824947086066,1167.31553788761,743.490442938311,1819.59295688961;1.20000000000000,0.246825639439050,6965.32316723397,3.93067095472466,2.03756657104806,1152.94564108414,735.305662830766,1822.13147472776;1.20000000000000,0.246952104201350,7322.59680242877,3.89823726063572,2.08489418063998,1139.01881413209,727.061724692446,1824.60897988135;1.20000000000000,0.247074892678032,7688.88371733632,3.86399848151215,2.13022775763987,1125.48235460304,718.823716595091,1827.02514763483;1.20000000000000,0.247200619203421,8063.87886486993,3.82826172901831,2.17357202573668,1112.30129206924,710.637188964721,1829.38010936493;1.20000000000000,0.247316247741818,8447.37083320346,3.79128778086537,2.21493926831872,1099.45244614134,702.534249232028,1831.67431510885;1.20000000000000,0.247432079086648,8838.92522504335,3.75330041588667,2.25434798113238,1086.92035471977,694.537706031907,1833.90843899645;1.20000000000000,0.247544373711900,9238.28738941421,3.71449348737431,2.29182179200124,1074.69472216059,686.663883382099,1836.08331383038;1.20000000000000,0.247653641302043,9645.12117188552,3.67503623562000,2.32738858438557,1062.76845501256,678.924557267625,1838.19988546123;1.20000000000000,0.247759838133943,10059.0937477698,3.63507740451180,2.36107977566643,1051.13649255191,671.328263320177,1840.25918078573;1.20000000000000,0.247862892156354,10479.8641252050,3.59474845297702,2.39292971638756,1039.79497929457,663.881198655887,1842.26228494549;1.20000000000000,0.247962622210231,10907.0831165825,3.55416609814291,2.42297518480230,1028.74072206688,656.587841308079,1844.21032487210;1.20000000000000,0.248058855964208,11340.3918887123,3.51343435649163,2.45125495763581,1017.97083405047,649.451378739563,1846.10445719225;1.20000000000000,0.248151473578022,11779.4232054622,3.47264620346454,2.47780944260721,1007.48250599909,642.474006634584,1847.94585915034;1.20000000000000,0.248241457754791,12223.8035614568,3.43188493871592,2.50268036162864,997.272862229551,635.657139568734,1849.73572163570;1.20000000000000,0.248335697185713,12673.1782725228,3.39122532118832,2.52591047605582,987.338873454914,629.001561621572,1851.47524369493;1.20000000000000,0.248448682950290,13127.3432306126,3.35073451767390,2.54754334718414,977.677299974044,622.507535946815,1853.16562810645;1.20000000000000,0.248546040621252,13586.4027927449,3.31047288026917,2.56762312644638,968.284621986091,616.174885276048,1854.80807772853;1.20000000000000,0.248558876494449,14049.5442187628,3.27049456706552,2.58619437029195,959.156959436793,610.003047712571,1856.40379241623;1.20000000000000,0.248724328845624,14514.3229038848,3.23084824533303,2.60330187521129,950.290385651067,603.991111576129,1857.95396633342;1.20000000000000,0.248786647118949,14984.7947255056,3.19157792016475,2.61899053446433,941.681317400562,598.137880806140,1859.45978551262;1.20000000000000,0.248786176091034,15457.3577356611,3.15272262120744,2.63330521910684,933.324695598792,592.441973892591,1860.92242587623;1.20000000000000,0.248981263917860,15930.1762041174,3.11431740267577,2.64629065415936,925.216262936608,586.901684404487,1862.34305195324;1.20000000000000,0.248945525439564,16408.9505156436,3.07639382286366,2.65799132287227,917.351860375171,581.515143145398,1863.72281462145;1.20000000000000,0.249041582115841,16885.8402321056,3.03897938713650,2.66845138537205,909.725766144767,576.280362967278,1865.06284998809;1.20000000000000,0.249162718872427,17365.3176860715,3.00209891382238,2.67771458541617,902.333893784965,571.195075165298,1866.36427858586;1.20000000000000,0.249289757023566,17847.5826917080,2.96577404730134,2.68582419362632,895.170915965286,566.256982848168,1867.62820342478;1.20000000000000,0.249330832413485,18332.1525937463,2.93002349665127,2.69282293996820,888.231419646676,561.463617729912,1868.85570982063;1.20000000000000,0.249333633717450,18815.6645509931,2.89486332626121,2.69875295388527,881.510047439471,556.812364612031,1870.04786422105;1.20000000000000,0.249406176951868,19296.9746911320,2.86030747678671,2.70365571319467,875.001935374688,552.300497857035,1871.20571320483;1.20000000000000,0.249460460955011,19778.7217952245,2.82636792754370,2.70757200728447,868.702220958726,547.925262988924,1872.33028273792;1.20000000000000,0.249484984876657,20259.8690206983,2.79305450969084,2.71054190529095,862.605513163470,543.683882694253,1873.42257800181;1.20000000000000,0.249630946449375,20739.1477226835,2.76037514983327,2.71260472040095,856.706563251615,539.573498003543,1874.48358326406;1.20000000000000,0.249565929813338,21220.9393869398,2.72833608401013,2.71379898113676,851.000261960214,535.591201911707,1875.51426133740;1.20000000000000,0.249783320459161,21696.4048194795,2.69694160642473,2.71416240870859,845.480940554068,531.734065834769,1876.51555327487;1.20000000000000,0.249670307160178,22177.1240460302,2.66619491163421,2.71373188865150,840.144057801684,527.999076821829,1877.48837825068;1.20000000000000,0.249845097676906,22648.5742936988,2.63609724692521,2.71254346422606,834.983688686147,524.383289949939,1878.43363300169;1.20000000000000,0.249831855085365,23123.6086091317,2.60664913752962,2.71063230879354,829.995618889388,520.883648427302,1879.35219233648;1.20000000000000,0.249801130214849,23593.1462883301,2.57784946507473,2.70803272951194,825.174216094808,517.497211554383,1880.24490838437;1.20000000000000,0.250110413989282,24057.0846877738,2.54969623742753,2.70477814790101,820.514887104193,514.220960964132,1881.11261144134;1.20000000000000,0.249952539758872,24530.0183860702,2.52218658134500,2.70090110013918,816.013008856994,511.051941050702,1881.95610945831;1.20000000000000,0.250014376384358,24989.2312103573,2.49531598071057,2.69643323716932,811.662778283181,507.987242612711,1882.77618851320;1.20000000000000,0.250271217541293,25446.6751778754,2.46907975431398,2.69140530575785,807.460480563781,505.023851799948,1883.57361316785;1.20000000000000,0.250131665456253,25910.3110555005,2.44347228947839,2.68584716697176,803.401339990413,502.158921915690,1884.34912576697;1.20000000000000,0.250188731826967,26360.0921112528,2.41848678517344,2.67978779503442,799.480159854519,499.389612145266,1885.10344764077;1.20000000000000,0.250357486419988,26807.3609139088,2.39411636420986,2.67325526978790,795.693321120251,496.713035811188,1885.83727917692;1.20000000000000,0.249970183647144,27256.7789825690,2.37035344545018,2.66627679714845,792.036372083727,494.126458973346,1886.55129953020;1.20000000000000,0.249897441015247,27680.9460230068,2.34718964890035,2.65887871335599,788.504712968062,491.627169472045,1887.24616772277;1.20000000000000,0.249919263516426,28099.9506563943,2.32461698489782,2.65108648674460,785.095466836167,489.212454708330,1887.92252282613;1.20000000000000,0.249750121904561,28518.3483652798,2.30262684952437,2.64292474919843,781.804450113056,486.879808444694,1888.58098398728;1.20000000000000,0.249242751495153,28925.7581955876,2.28120996531456,2.63441730170658,778.627388361509,484.626732087969,1889.22215190241;1.20000000000000,0.248511732329787,29307.1009914200,2.26035686541434,2.62558711829678,775.560693590627,482.450722207023,1889.84660889749;1.20000000000000,0.247523528741219,29656.5858503589,2.24005834982472,2.61645636197472,772.601497384850,480.349353861513,1890.45491892130;1.20000000000000,0.245334671936333,29967.9658859421,2.22030547907021,2.60704641167097,769.747052195321,478.320350990367,1891.04762812177;1.20000000000000,0.258278145695364,30188.2876380772,2.20108957448133,2.59737788835595,766.994735426221,476.361570667218,1891.62526591425;1.20000000000000,0.258278145695364,31118.3006244211,2.18240349855975,2.58747068050908,764.343878410994,474.470991043909,1892.18834593793;1.20000000000000,0.258278145695364,31900.0234122129,2.16421995832872,2.57734400096035,761.763173127003,472.646921220015,1892.73736692654;1.20000000000000,0.258278145695364,32572.5966101064,2.14652062100713,2.56701589989456,759.259497344877,470.884257315879,1893.27281504679;1.02244962234664,0.258278145695364,33164.7008457375,2.12929217186573,2.55650351792237,756.835704739997,469.179757584186,1893.79514002596;1.13951127245920,0.258278145695364,33697.3904548325,2.11470657829076,2.54582323427096,757.583789961065,467.531181452271,1894.30476824017;1.07008365550580,0.258278145695364,34185.1380507370,2.10075467804603,2.53504531787145,755.965238828600,466.307783166255,1894.80210975687;0.876981560228698,0.258278145695364,34639.1502162500,2.08817400130143,2.52418805187582,755.509404970841,465.139237259558,1895.29015882241;0.0360668458213482,0.258278145695364,35067.2884085404,2.07882404610275,2.51328770061146,757.939454049342,464.153921157620,1895.76931301798;0.0528933963856510,0.258278145695364,35474.9126700772,2.08073112124187,2.50242610924874,772.497558911561,463.660932130407,1896.24086798422];
end

% check whether are using a timestep that is twice as long as stored guess
if size(guess,1)==Params.horizon/2 
    rowskeep = [1:size(guess,1)]';
    rowskeep = rowskeep.*mod(rowskeep,2);
    rowskeep(rowskeep==0) = [];
    guess = guess(rowskeep,:);
    clear rowskeep;
end

if size(guess,1)>Params.horizon
    guess = guess(1:Params.horizon,:);
elseif size(guess,1)<Params.horizon
    guess = [guess; bsxfun(@times,ones(Params.horizon-size(guess,1),size(guess,2)),guess(end,:))];
end

% vector of controls for obtaining feasible starting guess
if Params.fixsavings>=0
    policyguess = guess(:,1);
else
    policyguess = [ guess(:,1); guess(:,2) ];
    if Params.dicelrsavings==1
        policyguess(end-round(5*10/Params.timestep)+1:end,:) = [];
    end
end
if strcmp(Params.carbonmodel,'fair')
    policyguess = [ guess(:,end); policyguess ];
end
% ensure starting trajectory is feasible
[ C, ~, K, T, M, ~, Tocean, ~, ~] = trajectory( policyguess, 1, Params.horizon, Fun, Params );
if Params.fixsavings>=0
    guess(:,2) = Params.fixsavings*ones(size(guess,1),1);
end
if strcmp(Params.carbonmodel,'fair')
    if Params.consumptionascontrol
        guess = [ guess(:,1) guess(:,2) C K T Tocean M guess(:,end)];
    else
        guess = [ guess(:,1) guess(:,2) K T Tocean M guess(:,end)];
    end
else
    if Params.consumptionascontrol
        guess = [ guess(:,1) guess(:,2) C K T Tocean M ];
    else
        guess = [ guess(:,1) guess(:,2) K T Tocean M ];
    end
end

% store columns for guess
Params.col_abaterate = 1;
Params.col_savingsrate = 2;
if Params.consumptionascontrol
    Params.col_C = 3;
    Params.col_K = 4;
else
    Params.col_C = [];
    Params.col_K = 3;
end
Params.col_T = Params.col_K+1;
Params.col_Tocean = Params.col_T+1;
Params.col_M = [Params.col_Tocean+1:Params.col_Tocean+size(M,2)];
if strcmp(Params.carbonmodel,'fair')
   Params.col_alpha = size(guess,2);
end

clear C K T Tocean M;


%% Set up variable bounds

lb = zeros(size(guess,1),size(guess,2)); % all nonnegative
ub = Inf*ones(size(guess,1),size(guess,2));

% bounds on control variables
ub(:,Params.col_abaterate) = Params.bound_abate;
ub(:,Params.col_savingsrate) = 1; % savings rate cannot rise above 1

% bounds on state variables (for stability)
if Params.consumptionascontrol
    lb(:,Params.col_C) = 2; % consumption
end
lb(:,Params.col_K) = 1; % capital
lb(:,Params.col_T) = -1; % surface temperature
ub(:,Params.col_T) = 12; % surface temperature
lb(:,Params.col_Tocean) = -1; % ocean temperature
ub(:,Params.col_Tocean) = 20; % ocean temperature
switch Params.carbonmodel
    case 'dice'
        lb(:,Params.col_M) = bsxfun(@times,ones(Params.horizon,1),[0.5*588 100 1000 ]); % carbon sinks
    otherwise
        lb(:,Params.col_M(1)) = ones(Params.horizon,1)*0.5*588; % permanent sink
        lb(:,Params.col_M(2:end)) = bsxfun(@times,ones(Params.horizon,1),-7*Params.M0(2:end));
end
if strcmp(Params.carbonmodel,'fair')
    lb(:,Params.col_alpha) = 0.1;
    ub(:,Params.col_alpha) = 1000; % for stability - Millar et al. 2017 pg 7216 use 100 but Dietz et al use 1000
end


%% Adjust if solving by simulating trajectory conditional on policy

if Params.transitionsasconstraints~=1

    % initial guess vector: abatement rate, savings rate, and possibly alpha
    if Params.fixsavings>=0
        if ~strcmp(Params.carbonmodel,'fair')
            guess = guess(:,Params.col_abaterate);
            ub = ub(:,Params.col_abaterate);
            lb = lb(:,Params.col_abaterate);
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate) ];
        end
    else
        if ~strcmp(Params.carbonmodel,'fair')
            guess = [ guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        else
            guess = [ guess(:,Params.col_alpha); guess(:,Params.col_abaterate); guess(:,Params.col_savingsrate) ];
            ub = [ ub(:,Params.col_alpha); ub(:,Params.col_abaterate); ub(:,Params.col_savingsrate) ];
            lb = [ lb(:,Params.col_alpha); lb(:,Params.col_abaterate); lb(:,Params.col_savingsrate) ];
        end
        if Params.dicelrsavings==1 % don't guess these fixed savings variables
            guess(end-round(5*10/Params.timestep)+1:end,:) = [];
            ub(end-round(5*10/Params.timestep)+1:end,:) = [];
            lb(end-round(5*10/Params.timestep)+1:end,:) = [];
        end
    end     
    
end


%% Scale variables around guessed path

if Params.scalevars
    Params.normalization = guess;
    Params.normalization(Params.normalization < 1e-5) = 1;
elseif Params.transitionsasconstraints
    Params.normalization = ones(size(guess));
else
    Params.normalization = 1;
end

guess = guess./Params.normalization;
ub = ub./Params.normalization;
lb = lb./Params.normalization;